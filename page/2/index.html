<!DOCTYPE html>
<html lang="zh-Hans">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="xushun" />


    
    


<meta property="og:type" content="website">
<meta property="og:title" content="mimimomo的博客">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="mimimomo的博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="mimimomo的博客">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="mimimomo的博客" type="application/atom+xml">



    <link rel="shortcut icon" href="/favicon.png">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">


    <style> .article { opacity: 0;} </style>


<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>mimimomo的博客</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: undefined
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/avatar.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">xushun</a></h1>
        </hgroup>

        

        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:123@123.com" title="Email"></a>
                            
                                <a class="fa GitHub" href="#" title="GitHub"></a>
                            
                                <a class="fa RSS" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="https://hexo.io">Hexo</a>
                    
                      <a class="main-nav-link switch-friends-link" href="https://pages.github.com/">GitHub</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://moxfive.xyz/">MOxFIVE</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">专注于前端</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">xushun</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/avatar.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">xushun</a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:123@123.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" href="#" title="GitHub"></a>
                            
                                <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我"/>
</nav>
      <div class="body-wrap">
  
    <article id="post-创建自定义块---样式指南" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/12/06/创建自定义块---样式指南/" class="article-date">
      <time datetime="2016-12-06T05:14:15.000Z" itemprop="datePublished">2016-12-06</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>Custom Blocks: Style Guide</p>
<blockquote>
<p>原文链接：<a href="https://developers.google.com/blockly/guides/create-custom-blocks/style-guide" target="_blank" rel="external">https://developers.google.com/blockly/guides/create-custom-blocks/style-guide</a></p>
</blockquote>
<p>多年来，Blockly和Blockly Games团队学到了许多适用于开发新块的课程。以下是我们所犯错误的集合，或者他人通常犯的错误。</p>
<p>些是我们使用Blockly的视觉风格学到的一般教训，可能不适用于所有用例或设计。存在其他解决方案。这也不是用户可能遇到的问题和如何避免他们的问题的详尽列表。每个案例都有点不同，并有自己的权衡。</p>
<p>##1. 条件与循环</p>
<hr>
<p>新用户最困难的块是条件和循环。许多基于块的环境将这两个块组合成相同的“控件”类别，两个块具有相同的形状和相同的颜色。这通常导致沮丧，因为新用户混淆两个块。阻止推荐将条件和循环移动到单独的“逻辑”和“循环”类别，每个类别具有不同的颜色。这清楚地表明，这些是不同的想法，行为不同，尽管具有类似的形状。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-23417add0a789fc1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<blockquote>
<p>建议：保持条件和循环分离。</p>
</blockquote>
<p>##2. 一个列表</p>
<hr>
<p>新手程序员在第一次遇到基于零的列表时反应不当。因此，Blockly通过使列表和字符串索引基于一个，跟随Lua和Lambda Moo的指导。</p>
<p>对于Blockly的更高级使用，支持从零开始的列表，以便更容易转换到文本。对于年轻或更多的新手观众，仍然建议基于单一的索引。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-6b71c5ce0e5b7356.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<blockquote>
<p>建议：1是第一个数字。</p>
</blockquote>
<p>##3. 用户输入</p>
<hr>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-7fbd10e05555a5b0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br>有三种方法从用户获取参数。下拉是最严格的，适合简单的教程和练习。输入字段允许更多的自由，并且有利于更多的创造性活动。值块输入（通常带有阴影块）提供了计算值（例如，随机生成器）而不仅仅是静态值的机会。</p>
<blockquote>
<p>建议：选择适合您用户的输入方法。</p>
</blockquote>
<p>##4.实时图像块</p>
<hr>
<p>块的文档应包括它所引用的块的图像。拍摄截图很容易。但是如果有50个这样的图像，并且应用被翻译成50种语言，突然一个人维护2,500个静态图像。然后颜色方案改变，并且2,500个图像需要再次更新 -。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-dfc3a01ccf14a9be.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br>为了从这个维护噩梦中解脱出来，Blockly Games用只读模式下的Blockly实例替换了所有的屏幕截图。结果看起来与图片相同，但保证是最新的。只读模式使国际化成为可能。</p>
<blockquote>
<p>建议：如果您支持多种语言，请使用只读模式。</p>
</blockquote>
<p>##5. 表达左的另一种方法</p>
<hr>
<p>美国儿童的反馈（虽然有趣的是不是来自其他国家）显示左右之间的混乱。这通过添加箭头来解决。如果方向是相对的（例如，对于化身），箭头的风格是重要的。当化身朝向相反方向时，A→直箭头或↱箭头混乱。最有帮助的是圆形箭头，即使在转动的角度小于箭头指示的情况下。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-fdab18555eae669e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<blockquote>
<p>建议：如果可能，补充文本与Unicode图标。</p>
</blockquote>
<p>##6. 高级块</p>
<hr>
<p>在可能的情况下，应该采用更高级别的方法，即使它降低了执行性能或灵活性。考虑使用此Apps脚本表达式：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SpreadsheetApp.getActiveSheet().getDataRange().getValues()</div></pre></td></tr></table></figure></p>
<p>在保留所有潜在能力的1：1映射下，上述表达式将使用四个块来构建。但Blockly的目标是更高级的，并提供一个封装整个表达式的块。目标是优化95％的情况，即使它使剩余的5％更困难。 Blockly不打算替代基于文本的语言，它旨在帮助用户覆盖初始学习曲线，以便他们可以使用基于文本的语言。</p>
<blockquote>
<p>建议：不要盲目地将整个API转换为块。</p>
</blockquote>
<p>##7.可选的返回值</p>
<hr>
<p>许多基于文本编程的函数执行一个操作，然后返回一个值。可以使用或不使用此返回值。一个例子是栈的pop（）函数。可以调用Pop来获取和删除最后一个元素，也可以调用它来删除返回值被忽略的最后一个元素。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">var last = stack.pop();  // Get and remove last element.</div><div class="line">stack.pop();  // Just remove last element.</div></pre></td></tr></table></figure></p>
<p>基于块的语言通常不利于忽略返回值。值块必须插入接受值的东西。有几个策略来处理这个问题。</p>
<ul>
<li>a）解决问题。大多数基于块的语言设计语言以避免这些情况。例如，Scratch没有任何具有副作用和返回值的块。</li>
<li>b）提供两个块。如果工具箱中的空间不是问题，一个简单的解决方案是提供每种类型的块中的两个，一个具有和一个没有返回值。缺点是，这可能导致一个令人困惑的工具箱与许多几乎相同的块。</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-355d176a32dda6a5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<ul>
<li>c）变换一个块。使用下拉列表，复选框或其他控件，允许用户选择是否有返回值。然后，块根据其选项更改形状。在Blockly的列表访问块中可以看到一个例子。</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-cab25bd0ae28be4f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>d）去掉值（eat the value）。第一个版本的App Inventor创建了一个特殊的管道块，可以管理任何连接的值。用户不了解此概念，第二版的App Inventor删除了管道块，建议用户将该值分配给一次性变量。<br><img src="http://upload-images.jianshu.io/upload_images/2433593-d1d83e879caf0242.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<blockquote>
<p>建议：每个策略都有利弊，选择适合您的用户。</p>
</blockquote>
<p>##8. Growing blocks</p>
<hr>
<p>某些块可能需要可变数量的输入。示例是将任意数字集合相加的添加块，或者具有任意组的elseif子句的if / elseif / else块，或者具有任意数量的初始化元素的列表构造器。有几种策略，每种策略都有其优点和缺点。</p>
<ul>
<li>a）最简单的方法是使用户从较小的块中组成块。一个示例是通过嵌套两个两个数字加法块来添加三个数字。另一个例子是只提供if / else块，并让用户嵌套他们创建elseif条件。</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-aa27fe5f946ccfef.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>这种方法的优点是其最初的简单性（对于用户和开发者）。缺点是在存在大量嵌套的情况下，代码变得非常麻烦并且对于用户来说难以阅读和维护。</p>
<ul>
<li>b）另一种方法是动态扩展块，以便在末端总有一个空闲输入。同样，如果在末尾有两个空闲输入，块将删除最后一个输入。这是App Inventor的第一个版本使用的方法</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-c98db981b001343b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>App Inventor的用户对于自动增长的块不喜欢几个原因。首先，总是有一个自由的输入，程序从来没有“完整”。第二，在堆栈中间插入一个元素是令人沮丧的，因为它涉及断开编辑下面的所有元素并重新连接它们。也就是说，如果顺序不重要，并且用户可以在他们的程序中感到空洞，这是一个非常方便的选择。</p>
<ul>
<li>c）为了解决孔问题，一些开发人员添加+/-按钮到手动添加或删除输入的块。打开Roberta使用两个这样的按钮从底部添加或删除输入。其他开发者在每行添加两个按钮，使得可以适应从堆栈的中间插入和删除。其他在每行添加两个向上/向下按钮，以便可以适应堆栈的重新排序。</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-75f224a0bae510b1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br>这个策略是一系列选项，从每个块只有两个按钮，到每行四个按钮。一方面，用户无法执行他们所需的操作的危险，另一方面，用户界面中充满了按钮，它看起来像是企业号（he starship Enterprise.）。</p>
<ul>
<li>d）最灵活的方法是在块中添加一个mutator bubble。这表示为打开该块的配置对话框的单个按钮。元素可以随意添加，删除或重新排列。</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-0411bc57493ae039.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>这种方法的缺点是它的mutator对新手用户不直观。引入突变者需要某种形式的指令。面向年幼儿童的基于块的应用程序不应使用mutator。虽然一旦学到，他们对于高级用户是无价的。</p>
<blockquote>
<p>建议：每个策略都有利弊，选择适合您的用户。</p>
</blockquote>
<p>##9.整洁的代码的生成</p>
<hr>
<p>高级Blockly用户应该能够查看生成的代码（JavaScript，Python，PHP，Lua，Dart等）并立即识别他们编写的程序。这意味着需要额外的努力来保持这个机器生成的代码可读。多余的括号，数字变量，粉碎的空格和冗长的代码模板都会妨碍生成优雅的代码。生成的代码应包含注释，并且应符合Google的样式指南<a href="https://github.com/google/styleguide/blob/gh-pages/README.md" target="_blank" rel="external">Google’s style guides</a>。</p>
<blockquote>
<p>建议：为您生成的代码感到自豪。显示给用户。</p>
</blockquote>
<p>##10.语言依赖</p>
<hr>
<p>对整洁的代码的期望的副作用是Blockly的行为在很大程度上根据交叉编译语言的行为来定义。最常见的输出语言是JavaScript，但是如果Blockly被交叉编译为不同的语言，则不应进行不合理的尝试以保留两种语言的确切行为。例如，在JavaScript中，空字符串为false，而在Lua中为true。定义一个单独的行为模式，Blockly的代码执行，而不管目标语言如何，将导致看起来像从GWT编译器出来的不可维护的代码。</p>
<blockquote>
<p>建议：块式不是一种语言，允许现有语言影响行为。</p>
</blockquote>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-创建自定义块---定义块" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/12/06/创建自定义块---定义块/" class="article-date">
      <time datetime="2016-12-06T05:14:15.000Z" itemprop="datePublished">2016-12-06</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>Create Custom Blocks - Define Blocks</p>
<blockquote>
<p>原文链接：<a href="https://developers.google.com/blockly/guides/create-custom-blocks/define-blocks" target="_blank" rel="external">https://developers.google.com/blockly/guides/create-custom-blocks/define-blocks</a></p>
</blockquote>
<p>块定义描述块的外观和行为，包括文本，颜色，形状，以及可以连接到的其他块。一旦定义了自定义块，每个平台都会以不同的方式加载这些定义，详细信息请参见<a href="https://developers.google.com/blockly/guides/configure/web/custom-blocks" target="_blank" rel="external">web</a>和<a href="https://developers.google.com/blockly/guides/configure/android/add-custom-blocks" target="_blank" rel="external">Android</a>特定的配置指南。</p>
<blockquote>
<p>注意：大多数块可以使用<a href="https://developers.google.com/blockly/guides/create-custom-blocks/blockly-developer-tools" target="_blank" rel="external">Blockly Developer Tools</a>定义，而不是手动创建下面的代码。</p>
</blockquote>
<p>##JSON格式与JavaScript API</p>
<hr>
<p>Blockly有两种定义块的方法。 JSON格式是跨平台的，因此相同的代码可用于定义网络，Android和iOS上的块。此外，JSON格式旨在简化为不同字排序的语言开发时的国际化过程。 JSON格式是定义块的首选方法。<br>但是，JSON格式无法定义高级功能，例如mutator或验证器。使用这些更复杂的功能的Web上的块需要使用JavaScript API进行定义。正在为其他平台开发单独的API，但目前不可用。</p>
<blockquote>
<p><strong>JS</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">Blockly.Blocks[&apos;string_length&apos;] = &#123;</div><div class="line"> init: function() &#123;</div><div class="line">   this.appendValueInput(&apos;VALUE&apos;)</div><div class="line">       .setCheck(&apos;String&apos;)</div><div class="line">       .appendField(&apos;length of&apos;);</div><div class="line">   this.setOutput(true, &apos;Number&apos;);</div><div class="line">   this.setColour(160);</div><div class="line">   this.setTooltip(&apos;Returns number of letters in the provided text.&apos;);</div><div class="line">   this.setHelpUrl(&apos;http://www.w3schools.com/jsref/jsref_length_string.asp&apos;);</div><div class="line"> &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
</blockquote>
<p>JSON<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line"> &quot;type&quot;: &quot;string_length&quot;,</div><div class="line"> &quot;message0&quot;: &apos;length of %1&apos;,</div><div class="line"> &quot;args0&quot;: [</div><div class="line">   &#123;</div><div class="line">     &quot;type&quot;: &quot;input_value&quot;,</div><div class="line">     &quot;name&quot;: &quot;VALUE&quot;,</div><div class="line">     &quot;check&quot;: &quot;String&quot;</div><div class="line">   &#125;</div><div class="line"> ],</div><div class="line"> &quot;output&quot;: &quot;Number&quot;,</div><div class="line"> &quot;colour&quot;: 160,</div><div class="line"> &quot;tooltip&quot;: &quot;Returns number of letters in the provided text.&quot;,</div><div class="line"> &quot;helpUrl&quot;: &quot;http://www.w3schools.com/jsref/jsref_length_string.asp&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>两个示例加载相同的“string_length”块。<br><img src="http://upload-images.jianshu.io/upload_images/2433593-c065c4b1f2b72366.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="">在Web上，使用initJson函数加载JSON格式。这也允许在Blockly网页中混合两种格式。最好尽可能使用JSON定义块，并且仅对JSON不支持的块定义的一部分使用JavaScript。面是一个块的示例，该块主要使用JSON定义，但使用JavaScript API扩展以包含动态工具提示。</p>
<blockquote>
<p><strong>JavaScript</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">var mathChangeJson = &#123;</div><div class="line"> &quot;message0&quot;: &quot;change %1 by %2&quot;,</div><div class="line"> &quot;args0&quot;: [</div><div class="line">   &#123;&quot;type&quot;: &quot;field_variable&quot;, &quot;name&quot;: &quot;VAR&quot;, &quot;variable&quot;: &quot;item&quot;&#125;,</div><div class="line">   &#123;&quot;type&quot;: &quot;input_value&quot;, &quot;name&quot;: &quot;DELTA&quot;, &quot;check&quot;: &quot;Number&quot;&#125;</div><div class="line"> ],</div><div class="line"> &quot;previousStatement&quot;: null,</div><div class="line"> &quot;nextStatement&quot;: null,</div><div class="line"> &quot;colour&quot;: 230</div><div class="line">&#125;;</div><div class="line">​</div><div class="line">Blockly.Blocks[&apos;math_change&apos;] = &#123;</div><div class="line"> init: function() &#123;</div><div class="line">   this.jsonInit(mathChangeJson);</div><div class="line">   // Assign &apos;this&apos; to a variable for use in the tooltip closure below.</div><div class="line">   var thisBlock = this;</div><div class="line">   this.setTooltip(function() &#123;</div><div class="line">     return &apos;Add a number to variable &quot;%1&quot;.&apos;.replace(&apos;%1&apos;,</div><div class="line">         thisBlock.getFieldValue(&apos;VAR&apos;));</div><div class="line">   &#125;);</div><div class="line"> &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
</blockquote>
<p>##块颜色</p>
<hr>
<blockquote>
<p>JSON<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line"> // ...,</div><div class="line"> &quot;colour&quot;: 160,</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p>JavaScript<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">init: function() &#123;</div><div class="line"> // ...</div><div class="line"> this.setColour(160);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Blockly使用色相饱和度值<a href="https://en.wikipedia.org/wiki/HSL_and_HSV" target="_blank" rel="external">Hue-Saturation-Value</a>（HSV）颜色模型。饱和度和值硬编码为Blockly，而Hue在每个块上定义。这确保开发人员有自由从各种各样的颜色中作出选择，同时仍然保证所有的块将在视觉上搭配在一起。它还允许通过简单地调整两个硬编码的饱和度和值常数来使整个Blockly外观和感觉变得更亮（对于儿童）或更令人暗（对于商业）。<img src="http://upload-images.jianshu.io/upload_images/2433593-e90f4260fb6a1ba4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="">要找到一个好的颜色，请访问此HSV选取器<a href="http://www.rapidtables.com/web/color/color-picker.htm" target="_blank" rel="external">HSV picker</a>，输入Blockly的饱和度和值常数（默认值分别为45％和65％），然后根据需要滑动色相。将此Hue值用作this.setColour函数的参数。注意英国的拼写。未能设置颜色会导致黑色块。</p>
<p>##语句连接</p>
<hr>
<p>用户可以使用<code>nextStatement</code>和<code>prevStatement</code>连接器创建块序列。在Blockly的标准布局中，这些连接在顶部和底部，垂直堆叠的块。<br>具有先前连接器的块不能具有输出连接器<a href="https://developers.google.com/blockly/guides/create-custom-blocks/define-blocks#block_output" target="_blank" rel="external">output connector</a>，反之亦然。术语语句块是指没有值输出的块。语句块通常具有前一个连接和下一个连接。<br>nextStatement<br>和prevStatement<br>连接可以打字，但标准块不使用此功能。</p>
<p>####下一个连接<br>在块的底部创建一个点，以便其他语句可以堆叠在其下面。具有下一个连接但没有先前连接的块通常表示一个事件，并且可以配置为使用帽子<a href="https://developers.google.com/blockly/guides/create-custom-blocks/block-paradigms#event_driven_program" target="_blank" rel="external">a hat</a>进行渲染。<br><img src="http://upload-images.jianshu.io/upload_images/2433593-aa10d9ad38f20f41.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<blockquote>
<p><strong>JSON</strong><br>Untyped:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123; </div><div class="line">   ...,  </div><div class="line"> &quot;nextStatement&quot;: null,</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p>Typed(rare)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;  </div><div class="line"> &quot;nextStatement&quot;: &quot;Action&quot;,  </div><div class="line"> ...</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>JavaScript</strong>Untyped<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">this.setNextStatement(true);  // false implies no next connector, the default</div></pre></td></tr></table></figure></p>
<p>Typed(rare)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">this.setNextStatement(true, &apos;Action&apos;);</div></pre></td></tr></table></figure></p>
<p>####上一个连接<br>在块的顶部创建一个缺口，以便它可以作为堆栈语句连接。具有先前连接的块不能具有输出连接。<br><img src="http://upload-images.jianshu.io/upload_images/2433593-b5d8d0f0bb68f191.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<blockquote>
<p><strong>JSON</strong><br>Untyped:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123; </div><div class="line">   ...,  </div><div class="line"> &quot;prevStatement&quot;: null,</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p>Typed(rare)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;  </div><div class="line"> &quot;prevStatement&quot;: &quot;Action&quot;,  </div><div class="line"> ...</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>JavaScript</strong><br>Untyped<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">this.setPreviousStatement(true);  // false implies no previous connector, the default</div></pre></td></tr></table></figure></p>
<p>Typed (rare):<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">this.setPreviousStatement(true, &apos;Action&apos;);</div></pre></td></tr></table></figure></p>
<p>##块输出</p>
<p>块可以具有单个输出，在前缘上表示为公头连接器。输出连接到值输入。具有输出的块通常称为值块。<br><img src="http://upload-images.jianshu.io/upload_images/2433593-70998b995e30f98a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<blockquote>
<p><strong>JSON</strong>Untyped<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line"> // ...,</div><div class="line"> &quot;output&quot;: null,</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p>Typed<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line"> // ...,</div><div class="line"> &quot;output&quot;: &quot;Number&quot;,</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>JavaScript</strong><br>Untyped<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">init: function() &#123;</div><div class="line"> // ..</div><div class="line"> this.setOutput(true);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Typed<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">init: function() &#123;</div><div class="line"> // ...</div><div class="line"> this.setOutput(true, &apos;Number&apos;);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>具有输出连接器的块也不能具有先前的语句缺口。<br>块输入</p>
<p>块具有一个或多个输入，其中每个输入是可以在连接中结束的标签和字段的序列。有三种类型的输入，匹配连接类型：<br>值输入：连接到值块的输出连接<a href="https://developers.google.com/blockly/guides/create-custom-blocks/define-blocks#block_output" target="_blank" rel="external">output connection</a>。 math_arithmetic块（加法，减法）是具有两个值输入的块的示例。</p>
<p>语句输入：连接到语句块的先前连接<a href="https://developers.google.com/blockly/guides/create-custom-blocks/define-blocks#previous_connection" target="_blank" rel="external">previous connection</a>。 while循环的嵌套部分是语句输入的示例。</p>
<p>虚拟输入：没有块连接。当块配置为使用外部值输入时，其行为类似于换行。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-33928ff370b13cf9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="">JSON格式和JavaScript API使用稍微不同的模型来描述其输入。<br>JSON中的输入和字段<br>JSON定义的块被构造为内插消息字符串（message0，message1，…）的序列，其中每个内插令牌（％1，％2，…）是字段或输入端呈现，在消息内）在匹配的JSON argsN数组。这种格式旨在使国际化容易。</p>
<blockquote>
<p><strong>JSON</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line"> &quot;message0&quot;: &quot;set %1 to %2&quot;,</div><div class="line"> &quot;args0&quot;: [</div><div class="line">   &#123;</div><div class="line">     &quot;type&quot;: &quot;field_variable&quot;,</div><div class="line">     &quot;name&quot;: &quot;VAR&quot;,</div><div class="line">     &quot;variable&quot;: &quot;item&quot;</div><div class="line">   &#125;,</div><div class="line">   &#123;</div><div class="line">     &quot;type&quot;: &quot;input_value&quot;,</div><div class="line">     &quot;name&quot;: &quot;VALUE&quot;</div><div class="line">   &#125;</div><div class="line"> ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-b87309432d1e84c7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="">内插令牌必须完全匹配args0数组：没有重复，没有省略。令牌可以以任何顺序存在，这允许不同的语言改变块的布局。<br>插值令牌的任一边的文本被空白修剪。使用字符％<br>（例如，当引用百分比时）的文本应使用%%<br>，以便它不会被解释为插值令牌。<br>参数和参数类型的顺序定义块的形状。更改这些字符串之一可以完全更改块的布局。这在具有与英语不同的词序的语言中尤其重要。考虑一种假设的语言，其中“设置％1到％2”（如上面的例子中所使用的）需要颠倒表示“在％1中放置％2”<br>更改此一个字符串（并保持JSON的其余部分不变）结果显示如下块：<br><img src="http://upload-images.jianshu.io/upload_images/2433593-df282b838e1b5e2b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br>Blockly自动更改字段的顺序，创建虚拟输入，并从外部输入切换到内部输入。<br><strong>Args</strong><br>每个消息字符串与相同数字的args数组配对。例如，message0与args0一起传递。插值令牌（％1，％2，…）引用args数组的项。每个对象都有一个类型字符串。每个对象都有一个类型字符串。其余参数根据类型而异：<br><a href="https://developers.google.com/blockly/guides/create-custom-blocks/define-blocks#fields" target="_blank" rel="external"><strong>Fields</strong></a></p>
<p><a href="https://developers.google.com/blockly/guides/create-custom-blocks/define-blocks#text_field" target="_blank" rel="external">field_input
</a></p>
<p><a href="https://developers.google.com/blockly/guides/create-custom-blocks/define-blocks#drop-down_field" target="_blank" rel="external">field_dropdown
</a></p>
<p><a href="https://developers.google.com/blockly/guides/create-custom-blocks/define-blocks#checkbox_picker" target="_blank" rel="external">field_checkbox
</a></p>
<p><a href="https://developers.google.com/blockly/guides/create-custom-blocks/define-blocks#colour_picker_field" target="_blank" rel="external">field_colour
</a></p>
<p><a href="https://developers.google.com/blockly/guides/create-custom-blocks/define-blocks#number_field" target="_blank" rel="external">field_number
</a></p>
<p><a href="https://developers.google.com/blockly/guides/create-custom-blocks/define-blocks#angle_field" target="_blank" rel="external">field_angle
</a></p>
<p><a href="https://developers.google.com/blockly/guides/create-custom-blocks/define-blocks#variable_field" target="_blank" rel="external">field_variable
</a></p>
<p><a href="https://developers.google.com/blockly/guides/create-custom-blocks/define-blocks#date_field" target="_blank" rel="external">field_date
</a></p>
<p><a href="https://developers.google.com/blockly/guides/create-custom-blocks/define-blocks#label" target="_blank" rel="external">field_label
</a></p>
<p><a href="https://developers.google.com/blockly/guides/create-custom-blocks/define-blocks#image" target="_blank" rel="external">field_image
</a></p>
<p><a href="https://developers.google.com/blockly/guides/create-custom-blocks/define-blocks#block_inputs" target="_blank" rel="external"><strong>Inputs</strong></a></p>
<p>input_value</p>
<p>input_statement</p>
<p>input_dummy</p>
<p>每个对象也可以有一个alt字段。在Blockly不能识别对象的类型的情况下，alt对象在其位置被使用。例如，如果名为field_time的新字段添加到Blockly，使用此字段的块可以使用alt为旧版本的Blockly定义field_input fallback：</p>
<blockquote>
<p><strong>JSON</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &quot;message0&quot;: &quot;sound alarm at %1&quot;,</div><div class="line">  &quot;args0&quot;: [</div><div class="line">    &#123;</div><div class="line">      &quot;type&quot;: &quot;field_time&quot;,</div><div class="line">      &quot;name&quot;: &quot;TEMPO&quot;,</div><div class="line">      &quot;hour&quot;: 9,</div><div class="line">      &quot;minutes&quot;: 0,</div><div class="line">      &quot;alt&quot;:</div><div class="line">        &#123;</div><div class="line">          &quot;type&quot;: &quot;field_input&quot;,</div><div class="line">          &quot;name&quot;: &quot;TEMPOTEXT&quot;,</div><div class="line">          &quot;text&quot;: &quot;9:00&quot;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p>alt对象可以具有其自己的alt对象，从而允许链接。最终，如果Blockly不能在args0数组中创建一个对象（在尝试任何alt对象之后），那么该对象被简单地跳过。<br>如果消息字符串以不包含在输入中的文本或字段结尾，则虚拟输入将自动添加到块的末尾。因此，如果块上的最后一个输入是虚拟输入，则它可以从args数组中省略，并且不需要对消息进行插值。自动添加尾部虚拟输入允许翻译者更改消息，而无需修改JSON的其余部分。请参见本页前面的“设置％1到％2”（无虚拟输入）和“在％1中放置％2”（添加虚拟输入）的示例。</p>
<p><strong>lastDummyAlign0</strong><br>在极少数情况下，自动创建的尾随虚拟输入需要与“RIGHT”或“CENTER”对齐。如果未指定，则默认值为“LEFT”。</p>
<p>在下面的示例中，message0是“send email to %1 subject %2 secure %3”，Blockly自动为第三行添加一个虚拟输入。将lastDummyAlign0设置为“RIGHT”会强制此行对齐。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-d0aad04dcde8a03a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>当设计RTL（阿拉伯语和希伯来语）的块时，左右相反。因此，“右”将字段向左对齐。</p>
<p><strong>message1，args1，lastDummyAlign1</strong><br>一些块自然地分成两个或更多个单独的部分。考虑这个具有两行的重复块：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-4dd8e843dc0273a0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>如果使用单个消息描述此块，则message0属性将为“repeat %1 times %2 do %3”。这个字符串对于翻译者来说很尴尬，很难解释％2替换是什么意思。 ％2虚拟输入在某些语言中甚至可能不需要。并且可能存在希望共享第二行的文本的多个块。一个更好的方法是JSON使用多个消息和args属性：</p>
<blockquote>
<p><strong>JSON</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &quot;type&quot;: &quot;controls_repeat_ext&quot;,</div><div class="line">  &quot;message0&quot;: &quot;repeat %1 times&quot;,</div><div class="line">  &quot;args0&quot;: [</div><div class="line">    &#123;&quot;type&quot;: &quot;input_value&quot;, &quot;name&quot;: &quot;TIMES&quot;, &quot;check&quot;: &quot;Number&quot;&#125;</div><div class="line">  ],</div><div class="line">  &quot;message1&quot;: &quot;do %1&quot;,</div><div class="line">  &quot;args1&quot;: [</div><div class="line">    &#123;&quot;type&quot;: &quot;input_statement&quot;, &quot;name&quot;: &quot;DO&quot;&#125;</div><div class="line">  ],</div><div class="line">  &quot;previousStatement&quot;: null,</div><div class="line">  &quot;nextStatement&quot;: null,</div><div class="line">  &quot;colour&quot;: 120</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p>任何数量的message，args和lastDummyAlign属性都可以以JSON格式定义，从0开始并按顺序递增。请注意，块工厂不能将消息拆分为多个部分，但手动这样做是直接的。</p>
<p>####JavaScript中的输入和字段<br>JavaScript API包含每个输入类型的附加方法“</p>
<blockquote>
<p><strong>JavaScript</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">this.appendDummyInput()</div><div class="line">    .appendField(&apos;for each&apos;)</div><div class="line">    .appendField(&apos;item&apos;)</div><div class="line">    .appendField(new Blockly.FieldVariable());</div><div class="line">this.appendValueInput(&apos;LIST&apos;)</div><div class="line">    .setCheck(&apos;Array&apos;)</div><div class="line">    .setAlign(Blockly.ALIGN_RIGHT)</div><div class="line">    .appendField(&apos;in list&apos;);</div><div class="line">this.appendStatementInput(&apos;DO&apos;)</div><div class="line">    .appendField(&apos;do&apos;);</div></pre></td></tr></table></figure></p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-9de6f84bcf1cb510.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br>每个方法可以采用标识符字符串，由代码生成器使用。虚拟输入很少需要引用，并且标识符通常未设置。</p>
<p>如上所述，每个方法通过方法链接返回用于配置的输入对象。有三个功能用于配置输入。</p>
<h5 id="setCheck"><a href="#setCheck" class="headerlink" title="setCheck"></a>setCheck</h5><blockquote>
<p><strong><strong>JavaScript</strong></strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">input.setCheck(&apos;Number&apos;);</div></pre></td></tr></table></figure></p>
</blockquote>
<p>此可选功能用于连接输入的类型检查。如果给定一个参数null，默认值，那么这个输入可以连接到任何块。有关详细信息，请参阅类型检查<a href="https://developers.google.com/blockly/guides/create-custom-blocks/type-checks" target="_blank" rel="external">Type Checks</a>。</p>
<h5 id="setAlign"><a href="#setAlign" class="headerlink" title="setAlign"></a>setAlign</h5><blockquote>
<p><strong>JavaScript</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">input.setAlign(Blockly.ALIGN_RIGHT);</div></pre></td></tr></table></figure></p>
</blockquote>
<p>此可选功能用于对齐字段（见下文）。有三个自描述值可以作为参数传递给此函数：Blockly.ALIGN_LEFT，Blockly.ALIGN_RIGHT和Blockly.ALIGN_CENTRE。注意英语拼写的“centre”。左对齐是默认值。当设计RTL（阿拉伯语和希伯来语）的块时，左右相反。因此Blockly.ALIGN_RIGHT将字段向左对齐。</p>
<h4 id="appendField"><a href="#appendField" class="headerlink" title="appendField"></a>appendField</h4><p>一旦输入已经创建并且通过appendInput附加到块，可以可选地向输入附加任意数量的字段<a href="https://developers.google.com/blockly/guides/create-custom-blocks/define-blocks#fields" target="_blank" rel="external">fields</a>。这些字段通常用作标签来描述每个输入的用途。</p>
<blockquote>
<p>JavaScript<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">input.appendField(&apos;hello&apos;);</div></pre></td></tr></table></figure></p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-39161bf54fb15218.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br>最简单的字段元素是文本。 Blockly的惯例是使用所有小写文本，除了专有名称（例如Google，SQL）。</p>
<p>输入行可以包含任意数量的字段元素。多个appendField调用可以链接在一起，以有效地将多个字段添加到同一输入行。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-a9a41e1f9dabcd72.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><code>appendField（&#39;hello&#39;</code>）调用实际上是一个使用显式FieldLabel构造函数的快捷方式：<code>appendField（new Blockly.FieldLabel（&#39;hello&#39;））</code>。唯一需要使用构造函数的时间是指定一个类名，以便可以使用CSS规则对文本进行样式化。</p>
<p>####Inline vs. External<br>块输入可以呈现为外部或内部.</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-aeffedd66e2efafe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br>块定义可以指定一个可选的布尔值，控制输入是否为内联。如果为false，则任何值输入都将是外部的（例如左块）。如果为true，则任何值输入都将是内联的（例如上面的右框）.</p>
<blockquote>
<p><strong>JSON</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  // ...,</div><div class="line">  &quot;inputsInline&quot;: true</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p>JavaScript<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">init: function() &#123; </div><div class="line">   // ...  this.setInputsInline(true);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>如果没有定义，Blockly将使用一些启发式来猜测哪种模式是最好的。假设Blockly做出正确的选择，留下这个字段未定义是优选的，因为不同的语言翻译可以自动具有不同的模式。请参见本页前面的“set %1 to %2”（外部输入）和“put %2 in %1”（内联输入）的JSON示例。</p>
<p>##Fields 字段</p>
<hr>
<p>字段定义块中的UI元素。这些包括字符串标签，图像和字符数据<a href="https://en.wikipedia.org/wiki/Literal_(computer_programming" target="_blank" rel="external">literal</a>)（例如字符串和数字）的输入。最简单的示例是math_number块，可以是field_input（web）或field_number（Android）键入数字。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-107fb1900a58b36b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br>大多数字段都有一个名称字符串，用于在代码生成期间引用它们.</p>
<p>####Lable<br>标签字符串为其他字段和输入提供上下文。他们是如此常见和内在的翻译，他们有自己的符号。</p>
<blockquote>
<p><strong>JSON</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &quot;type&quot;: &quot;example_label&quot;,</div><div class="line">  &quot;message0&quot;: &quot;a label %1 and another label&quot;,</div><div class="line">  &quot;args0&quot;: [</div><div class="line">    &#123;</div><div class="line">      &quot;type&quot;: &quot;input_dummy&quot;</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p>插值参数之间的任何消息文本都将成为标签字符串。或者，可以明确地将标签内插为对象或文本。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &quot;type&quot;: &quot;example_label&quot;,</div><div class="line">  &quot;message0&quot;: &quot;%1 %2 %3&quot;,</div><div class="line">  &quot;args0&quot;: [</div><div class="line">    &#123;</div><div class="line">      &quot;type&quot;: &quot;field_label&quot;,</div><div class="line">      &quot;text&quot;: &quot;a label&quot;</div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">      &quot;type&quot;: &quot;input_dummy&quot;</div><div class="line">    &#125;,</div><div class="line">    &quot;and another label&quot;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>JavaScript</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Blockly.Blocks[&apos;example_label&apos;] = &#123;</div><div class="line">  init: function() &#123;</div><div class="line">    this.appendDummyInput()</div><div class="line">        .appendField(new Blockly.FieldLabel(&apos;a label&apos;));</div><div class="line">    this.appendDummyInput()</div><div class="line">        .appendField(&apos;and another label&apos;);</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-fb854d40f2e7ad53.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br>当明确添加时，作者可以包括CSS样式名称以在Blockly for Web上自定义视图。</p>
<blockquote>
<p><strong>JSON</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &quot;type&quot;: &quot;example_styled_label&quot;,</div><div class="line">  &quot;message0&quot;: &quot;%1&quot;,</div><div class="line">  &quot;args0&quot;: [</div><div class="line">    &#123;</div><div class="line">      &quot;type&quot;: &quot;field_label&quot;,</div><div class="line">      &quot;text&quot;: &quot;Styled label&quot;,</div><div class="line">      &quot;class&quot;: &quot;style-name&quot;</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p><strong>JavaScript</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Blockly.Blocks[&apos;example_styled_label&apos;] = &#123;</div><div class="line">  init: function() &#123;</div><div class="line">    this.appendDummyInput()</div><div class="line">        .appendField(new Blockly.FieldLabel(&apos;Styled label&apos;, &apos;style-name&apos;));</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-3e3edfbc6467b233.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>####Image图片<br>像标签一样，图像通常是静态指示符，而不是输入字段。</p>
<blockquote>
<p><strong>JSON</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &quot;type&quot;: &quot;example_image&quot;,</div><div class="line">  &quot;message0&quot;: &quot;image: %1&quot;,</div><div class="line">  &quot;args0&quot;: [</div><div class="line">    &#123;</div><div class="line">      &quot;type&quot;: &quot;field_image&quot;,</div><div class="line">      &quot;src&quot;: &quot;https://www.gstatic.com/codesite/ph/images/star_on.gif&quot;,</div><div class="line">      &quot;width&quot;: 15,</div><div class="line">      &quot;height&quot;: 15,</div><div class="line">      &quot;alt&quot;: &quot;*&quot;</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p><strong>JavaScript</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">```Blockly.Blocks[&apos;example_labels&apos;] = &#123;</div><div class="line">  init: function() &#123;</div><div class="line">    this.appendDummyInput()</div><div class="line">        .appendField(&quot;image:&quot;)</div><div class="line">        .appendField(new Blockly.FieldImage(&quot;https://www.gstatic.com/codesite/ph/images/star_on.gif&quot;, 15, 15, &quot;*&quot;));</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-b2ff02cb43464738.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>使用图像URL和所需的高度和宽度创建FieldImage对象。图像将缩放到指定的尺寸，同时保留宽高比。该块将根据需要扩展以容纳图像。可选的第四个参数指定在块被折叠时使用的替代文本。<br>图片网址可以是相对的。在Web上，配置<code>Blockly.pathToBlockly</code>以指定Blockly的根目录。在Android上，相对网址被视为<br>[asset path]<br>（<a href="https://developer.android.com/reference/android/content/res/AssetManager.html#open（java.lang.String）。" target="_blank" rel="external">https://developer.android.com/reference/android/content/res/AssetManager.html#open（java.lang.String）。</a></p>
<h4 id="文本域Text-Field"><a href="#文本域Text-Field" class="headerlink" title="文本域Text Field"></a>文本域Text Field</h4><p>文本输入允许用户输入文本。</p>
<blockquote>
<p><strong>Json</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &quot;type&quot;: &quot;example_textinput&quot;,</div><div class="line">  &quot;message0&quot;: &quot;text input: %1&quot;,</div><div class="line">  &quot;args0&quot;: [</div><div class="line">    &#123;</div><div class="line">      &quot;type&quot;: &quot;field_input&quot;,</div><div class="line">      &quot;name&quot;: &quot;FIELDNAME&quot;,</div><div class="line">      &quot;text&quot;: &quot;default text&quot;</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p><strong>JavaScript</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Blockly.Blocks[&apos;example_textinput&apos;] = &#123;</div><div class="line">  init: function() &#123;</div><div class="line">    this.appendDummyInput()</div><div class="line">        .appendField(&quot;text input:&quot;);</div><div class="line">        .appendField(new Blockly.FieldTextInput(&apos;default text&apos;),</div><div class="line">                     &apos;FIELDNAME&apos;);</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-6267f847eca34acc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br>可选地，JavaScript FieldTextInput构造函数还可以接受第二个参数，该参数将成为验证函数或更改处理程序。有关重写用户输入的位置的示例，请参阅<code>math_number</code>。</p>
<p>默认情况下，文本输入是拼写检查，但可以选择关闭：</p>
<blockquote>
<p><strong>Json</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &quot;type&quot;: &quot;example_nospellcheck&quot;,</div><div class="line">  &quot;message0&quot;: &quot;no spell check: %1&quot;,</div><div class="line">  &quot;args0&quot;: [</div><div class="line">    &#123;</div><div class="line">      &quot;type&quot;: &quot;field_input&quot;,</div><div class="line">      &quot;name&quot;: &quot;FIELDNAME&quot;,</div><div class="line">      &quot;text&quot;: &quot;default text&quot;,</div><div class="line">      &quot;spellcheck&quot;: false</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p><strong>JavaScript</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">Blockly.Blocks[&apos;example_nospellcheck&apos;] = &#123;</div><div class="line">  init: function() &#123;</div><div class="line">    var textInput = new Blockly.FieldTextInput(&apos;default text&apos;);</div><div class="line">    textInput.setSpellcheck(false);</div><div class="line">    this.appendDummyInput()</div><div class="line">        .appendField(&quot;text input:&quot;);</div><div class="line">        .appendField(textInput, &apos;FIELDNAME&apos;);</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>####下拉字段Drop-down Field</p>
<blockquote>
<p><strong>Json</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &quot;type&quot;: &quot;example_dropdown&quot;,</div><div class="line">  &quot;message0&quot;: &quot;drop down: %1&quot;,</div><div class="line">  &quot;args0&quot;: [</div><div class="line">    &#123;</div><div class="line">      &quot;type&quot;: &quot;field_dropdown&quot;,</div><div class="line">      &quot;name&quot;: &quot;FIELDNAME&quot;,</div><div class="line">      &quot;options&quot;: [</div><div class="line">        [ &quot;first item&quot;, &quot;ITEM1&quot; ],</div><div class="line">        [ &quot;second item&quot;, &quot;ITEM2&quot; ]</div><div class="line">      ]</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p><strong>js</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">Blockly.Blocks[&apos;example_dropdown&apos;] = &#123;</div><div class="line">  init: function() &#123;</div><div class="line">    this.appendDummyInput()</div><div class="line">        .appendField(&apos;drop down:&apos;);</div><div class="line">        .appendField(new Blockly.FieldDropdown([</div><div class="line">                       [&apos;first item&apos;, &apos;ITEM1&apos;],</div><div class="line">                       [&apos;second item&apos;, &apos;ITEM2&apos;]</div><div class="line">                     ]),</div><div class="line">                     &apos;FIELDNAME&apos;);</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-8f3c37091ed6683a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br>下拉字段的项目列表由两部分列表的列表指定。每个内部列表的第一项是人类可读的名称;第二个是项目标识符字符串。<br>在Blockly for Web中，如果所有人类可读的字符串共享一些前缀或后缀，那么这些字符串将在下拉之前或之后作为标签提取。这允许前缀/后缀标签位置适应语言约定。此功能将在不久的将来移植到Android。</p>
<blockquote>
<p>注意：有关详细信息，请参阅下拉菜单<a href="https://developers.google.com/blockly/guides/create-custom-blocks/dropdown-menus" target="_blank" rel="external">Drop-Down Menus</a>。</p>
</blockquote>
<p>####复选框字段 Checkbox Field<br>复选框字段提供布尔输入。</p>
<blockquote>
<p><strong>Json</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &quot;type&quot;: &quot;example_checkbox&quot;,</div><div class="line">  &quot;message0&quot;: &quot;checkbox: %1&quot;,</div><div class="line">  &quot;args0&quot;: [</div><div class="line">    &#123;</div><div class="line">      &quot;type&quot;: &quot;field_checkbox&quot;,</div><div class="line">      &quot;name&quot;: &quot;FIELDNAME&quot;,</div><div class="line">      &quot;checked&quot;: true</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p><strong>js</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Blockly.Blocks[&apos;example_checkbox&apos;] = &#123;</div><div class="line">  init: function() &#123;</div><div class="line">    this.appendDummyInput()</div><div class="line">        .appendField(&apos;checkbox:&apos;);</div><div class="line">        .appendField(new Blockly.FieldCheckbox(&apos;TRUE&apos;), &apos;FIELDNAME&apos;);</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>可选地，FieldCheckbox构造函数还可以接受第二个参数，该参数将成为验证函数或更改处理程序。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-f84ddaf06a40a5a4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>####颜色选择器Colour Picker Field<br>颜色选择器允许用户从由编程器提供的一组不透明颜色中进行选择。</p>
<blockquote>
<p>注意：所有JavaScript和JSON Blockly API都使用英国的’color’拼写。 Android API使用美国拼写符合Android平台。</p>
</blockquote>
<p> ^_^</p>
<blockquote>
<p><strong>Json</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &quot;type&quot;: &quot;example_colour&quot;,</div><div class="line">  &quot;message0&quot;: &quot;colour picker: %1&quot;,</div><div class="line">  &quot;args0&quot;: [</div><div class="line">    &#123;</div><div class="line">      &quot;type&quot;: &quot;field_colour&quot;,</div><div class="line">      &quot;name&quot;: &quot;FIELDNAME&quot;,</div><div class="line">      &quot;colour&quot;: &quot;#ff0000&quot;</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p><strong>js</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Blockly.Blocks[&apos;example_colour&apos;] = &#123;</div><div class="line">  init: function() &#123;</div><div class="line">    this.appendDummyInput()</div><div class="line">        .appendField(&apos;colour picker:&apos;);</div><div class="line">        .appendField(new Blockly.FieldColour(&apos;#ff0000&apos;), &apos;FIELDNAME&apos;);</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-47832becc9603638.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>（可选）JavaScript FieldColour构造函数还可以接受第二个参数，该参数将成为验证函数或更改处理程序。<br>在Web Blockly中，可以全局设置所有颜色选择器中显示的颜色和列数的选择：</p>
<blockquote>
<p><strong>Js</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Blockly.FieldColour.COLOURS = [&apos;#f00&apos;,&apos;#0f0&apos;,&apos;#00f&apos;,&apos;#000&apos;,&apos;#888&apos;,&apos;#fff&apos;];</div><div class="line">Blockly.FieldColour.COLUMNS = 3;</div></pre></td></tr></table></figure></p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-12ec9ff45e3f7a85.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"></p>
<p>或者，可以给个人颜色选择器一个自定义选择：</p>
<blockquote>
<p><strong>js</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var colour = new Blockly.FieldColour(&apos;#ff0000&apos;);</div><div class="line">colour.setColours([&apos;#f00&apos;,&apos;#0f0&apos;,&apos;#00f&apos;,&apos;#000&apos;,&apos;#888&apos;,&apos;#fff&apos;]).setColumns(3);</div><div class="line">input.appendField(colour, &apos;COLOUR&apos;);</div></pre></td></tr></table></figure></p>
</blockquote>
<p>对于颜色列表使用任何CSS兼容格式，包括<code>＃f00</code>，<code>＃ff0000</code>或<code>rgb（255，0，0）</code>。</p>
<p>####变量字段Variable Field<br>另一个字段元素是变量选择菜单。该字段定义要使用的默认变量名（在本例中为“x”）。如果省略此名称，变量将是一个新的唯一变量（例如’i’，’j’，’k’…）。</p>
<blockquote>
<p><strong>Json</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &quot;type&quot;: &quot;example_variable&quot;,</div><div class="line">  &quot;message0&quot;: &quot;variable: %1&quot;,</div><div class="line">  &quot;args0&quot;: [</div><div class="line">    &#123;</div><div class="line">      &quot;type&quot;: &quot;field_variable&quot;,</div><div class="line">      &quot;name&quot;: &quot;FIELDNAME&quot;,</div><div class="line">      &quot;variable&quot;: &quot;x&quot;</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p><strong>js</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Blockly.Blocks[&apos;example_variable&apos;] = &#123;</div><div class="line">  init: function() &#123;</div><div class="line">    this.appendDummyInput()</div><div class="line">        .appendField(&apos;variable:&apos;);</div><div class="line">        .appendField(new Blockly.FieldVariable(&apos;x&apos;), &apos;FIELDNAME&apos;);</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-aac5672f2b59c97f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>####数字字段Number Field<br>数字字段提供数字输入和验证。在移动环境中，与正常的文本输入不同，这可以为屏幕上键盘产生数字键盘。</p>
<blockquote>
<p>警告：数字字段正在开发中。虽然Android和生成器正确支持数字字段，但是Web UI尚未实现。</p>
<p>.&lt;</p>
<p><strong>json</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &quot;type&quot;: &quot;example_number&quot;,</div><div class="line">  &quot;message0&quot;: &quot;number: %1&quot;,</div><div class="line">  &quot;args0&quot;: [</div><div class="line">    &#123;</div><div class="line">      &quot;type&quot;: &quot;field_number&quot;,</div><div class="line">      &quot;name&quot;: &quot;FIELDNAME&quot;,</div><div class="line">      &quot;value&quot;: 100</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p><strong>js</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Blockly.Blocks[&apos;example_number&apos;] = &#123;</div><div class="line">  init: function() &#123;</div><div class="line">    this.appendDummyInput()</div><div class="line">        .appendField(&quot;number:&quot;);</div><div class="line">        .appendField(new Blockly.FieldNumber(&apos;100&apos;), &apos;FIELDNAME&apos;);</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-3012ef603a4f1440.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br>使用附加参数，数字输入可以以多种方式约束。该范围可以受最小<code>min</code>和<code>max</code>最大值的约束。设置精度<code>precision</code>（通常为10的幂）在值之间执行最小步长。也就是说，用户的值将舍入到最接近的精度倍数。最低有效数字位置是从精度推断的。可以通过选择整数精度来强制执行整数值。</p>
<blockquote>
<p><strong>Json</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &quot;type&quot;: &quot;example_byte&quot;,</div><div class="line">  &quot;message0&quot;: &quot;%1&quot;,</div><div class="line">  &quot;args0&quot;: [</div><div class="line">    &#123;</div><div class="line">      &quot;type&quot;: &quot;field_number&quot;,</div><div class="line">      &quot;name&quot;: &quot;VALUE&quot;,</div><div class="line">      &quot;value&quot;: 0,</div><div class="line">      &quot;min&quot;: -128,</div><div class="line">      &quot;max&quot;: 127,</div><div class="line">      &quot;precision&quot;: 1</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p><strong>js</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Blockly.Blocks[&apos;example_byte&apos;] = &#123;</div><div class="line">  init: function() &#123;</div><div class="line">    this.appendDummyInput()</div><div class="line">        .appendField(new Blockly.FieldNumber(&apos;0&apos;, -128, 127, 1), &apos;FIELDNAME&apos;);</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>一些约束的组合是无效的，应该避免。例如，精度为5的1到4的范围没有有效值。<br>（可选）JavaScript <code>FieldNumber</code>构造函数还可以接受第五个参数，该参数将成为验证函数或更改处理程序。</p>
<p>####角度Angle Field<br>角度域提供了一个UI以图形方式选择一个角度。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-4cf102b2c0d82142.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>默认情况下，这是从0°（包括）到360°（排他）逆时针，0°到右边，和90°到顶部。超出范围的值被包装到此刻度上。可以使用键盘输入任意角度（即使是小数），但使用鼠标选择的角度将舍入为15°。</p>
<blockquote>
<p><strong>Json</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &quot;type&quot;: &quot;example_angle&quot;,</div><div class="line">  &quot;message0&quot;: &quot;angle: %1&quot;,</div><div class="line">  &quot;args0&quot;: [</div><div class="line">    &#123;</div><div class="line">      &quot;type&quot;: &quot;field_angle&quot;,</div><div class="line">      &quot;name&quot;: &quot;FIELDNAME&quot;,</div><div class="line">      &quot;angle&quot;: &quot;90&quot;</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p><strong>js</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Blockly.Blocks[&apos;example_angle&apos;] = &#123;</div><div class="line">  init: function() &#123;</div><div class="line">    this.appendDummyInput()</div><div class="line">        .appendField(&apos;angle:&apos;);</div><div class="line">        .appendField(new Blockly.FieldAngle(90), &apos;FIELDNAME&apos;);</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>（可选）JavaScript FieldAngleInput构造函数还可以接受第二个参数，该参数将成为验证函数或更改处理程序。</p>
<p>在web版本中，数字到表示角度的范围和映射可以通过<a href="https://github.com/google/blockly/blob/develop/core/field_angle.js" target="_blank" rel="external">field_angle.js
</a>中的常量来定制。在共享保存的工作区的Blockly的所有版本上，这样的自定义应该是相同的。</p>
<blockquote>
<p>注意：Android实现尚不是用户可编辑的字段：<a href="https://github.com/google/blockly-android/issues/317" target="_blank" rel="external">#317</a>。</p>
</blockquote>
<p>####Date Field日期字段</p>
<blockquote>
<p><strong>json</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &quot;type&quot;: &quot;example_date&quot;,</div><div class="line">  &quot;message0&quot;: &quot;date: %1&quot;,</div><div class="line">  &quot;args0&quot;: [</div><div class="line">    &#123;</div><div class="line">      &quot;type&quot;: &quot;field_angle&quot;,</div><div class="line">      &quot;name&quot;: &quot;FIELDNAME&quot;,</div><div class="line">      &quot;date&quot;: &quot;2015-02-05&quot;</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p><strong>js</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Blockly.Blocks[&apos;example_date&apos;] = &#123;</div><div class="line">  init: function() &#123;</div><div class="line">    this.appendDummyInput()</div><div class="line">        .appendField(&apos;date:&apos;)</div><div class="line">        .appendField(new Blockly.FieldDate(&apos;2015-02-05&apos;), &apos;FIELDNAME&apos;);</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-ba321031a2e22b23.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="append-field-date"><br>FieldDate显示日历日期。如果没有指定日期，则使用特定日期或今天日期进行初始化。<br>（可选）JavaScript FieldDate构造函数还可以接受第二个参数，该参数将成为验证函数或更改处理程序。</p>
<p>请注意，由于使用有限和占用空间大，<code>FieldDate</code>默认情况下不会编译为Blockly。将<code>goog.require（&#39;Blockly.FieldDate&#39;）</code>添加到您的项目以启用它。</p>
<blockquote>
<p>注意：Android实现尚不是用户可编辑的字段：<a href="https://github.com/google/blockly-android/issues/320" target="_blank" rel="external">#320</a>。</p>
</blockquote>
<p>##工具提示Tooltips</p>
<hr>
<p>当用户将鼠标悬停在块上时，工具提示提供即时帮助。如果文本很长，它将自动换行。</p>
<blockquote>
<p><strong>json</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  // ...,</div><div class="line">  &quot;tooltip&quot;: &quot;Tooltip text.&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p><strong>js</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">init: function() &#123;</div><div class="line">  this.setTooltip(&quot;Tooltip text.&quot;);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>在JavaScript API中，工具提示也可以定义为函数，而不是静态字符串。这允许动态帮助。有关根据所选择的下拉选项进行更改的工具提示的示例，请参见<code>math_arithmetic</code>。<br><strong>js</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">Blockly.Blocks[&apos;math_arithmetic&apos;] = &#123;</div><div class="line">  init: function() &#123;</div><div class="line">    // ...</div><div class="line"></div><div class="line">    // Assign &apos;this&apos; to a variable for use in the tooltip closure below.</div><div class="line">    var thisBlock = this;</div><div class="line">    this.setTooltip(function() &#123;</div><div class="line">      var mode = thisBlock.getFieldValue(&apos;OP&apos;);</div><div class="line">      var TOOLTIPS = &#123;</div><div class="line">        &apos;ADD&apos;: Blockly.Msg.MATH_ARITHMETIC_TOOLTIP_ADD,</div><div class="line">        &apos;MINUS&apos;: Blockly.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS,</div><div class="line">        &apos;MULTIPLY&apos;: Blockly.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY,</div><div class="line">        &apos;DIVIDE&apos;: Blockly.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE,</div><div class="line">        &apos;POWER&apos;: Blockly.Msg.MATH_ARITHMETIC_TOOLTIP_POWER</div><div class="line">      &#125;;</div><div class="line">      return TOOLTIPS[mode];</div><div class="line">    &#125;);</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>使用JavaScript API，块可以指定函数，而不是返回工具提示字符串的静态字符串。这允许动态工具提示。有关示例，请参见math_arithmetic。</p>
<p>##帮助网址Help URL</p>
<hr>
<p>块可以具有与其相关联的帮助页面。通过右键单击块并从上下文菜单中选择“帮助”，Blockly for Web的用户可以使用此功能。如果此值为null，则菜单将显示为灰色。</p>
<blockquote>
<p><strong>json</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  // ...,</div><div class="line">  &quot;helpUrl&quot;: &quot;https://en.wikipedia.org/wiki/For_loop&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p><strong>js</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">init: function() &#123;</div><div class="line">  // ...</div><div class="line">  this.setHelpUrl(&apos;https://en.wikipedia.org/wiki/For_loop&apos;);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>使用JavaScript API，块可以指定函数，而不是返回URL字符串的静态字符串，从而允许动态帮助。</p>
<p>##更改验证器（仅限JavaScript）</p>
<p>##Change Validator (JavaScript Only)</p>
<hr>
<p>块可以具有在对工作空间进行任何更改（包括与块不相关的那些）时调用的验证函数。这些主要用于设置块的警告文本或类似的用户通知在工作区之外。</p>
<p>该函数在init函数外添加，直接到块定义对象</p>
<blockquote>
<p><strong>js</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">Blockly.Blocks[&apos;block_type&apos;] = &#123;</div><div class="line">  init: function() &#123;</div><div class="line">    // ...</div><div class="line">  &#125;,</div><div class="line">  onchange: function(changeEvent) &#123;</div><div class="line">    if (this.getInput(&apos;NUM&apos;).connection.targetBlock()) &#123;</div><div class="line">      this.setWarningText(null);</div><div class="line">    &#125; else &#123;</div><div class="line">      this.setWarningText(&apos;Must have an input block.&apos;);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p>系统调用函数，传入<a href="https://developers.google.com/blockly/guides/configure/web/events#blocklyeventscreate" target="_blank" rel="external">change event</a>事件。在函数内部，这指的是块实例。</p>
<p>因为这个调用任何更改，如果使用，开发人员应该确保监听器运行快速。还应注意可能级联或循环回侦听器的工作空间的更改。(One should also be wary of changes to the workspace that might cascade or loop back to the listener.)</p>
<p>有关示例，请参见<code>controls_flow_statements</code>，<code>logic_compare和</code>procedures_ifreturn`块。</p>
<p>请注意，可编辑字段有自己的事件侦听器，用于输入验证和导致副作用。</p>
<p>##改变对象属性的方法    （仅限JavaScript）Mutator (JavaScript Only)</p>
<p>Mutator允许高级块改变形状，最明显的是由于用户打开对话框来添加，删除或重新排列组件。</p>
<blockquote>
<p><strong>js</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">init: function() &#123;</div><div class="line">  // ...</div><div class="line">  this.setMutator(new Blockly.Mutator([&apos;controls_if_elseif&apos;, &apos;controls_if_else&apos;]));</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-ff251fd25c432dbe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="controls-if"></p>
<p>???</p>
<blockquote>
<p>注意：了解有关创建变异器的更多信息<a href="https://developers.google.com/blockly/guides/create-custom-blocks/mutators" target="_blank" rel="external">Creating Mutators</a>。</p>
</blockquote>
<p>##每块配置   Per-block configuration</p>
<hr>
<p>块实例具有多个属性，配置它们对用户的行为。这些可以用于约束工作空间以反映域的某些属性（例如，恰好有一个“开始”事件），或者聚焦用户的成果（例如，教程）。</p>
<p>####可删除状态<br>默认情况下，用户可以删除可编辑工作区（不是readOnly）上的任何块。有时，使某些块永久固定是有用的。例如，教程框架代码。<br>···<br>block.setDeletable(false);<br>···</p>
<p>任何块，包括那些标记为不可删除的块，可以以编程方式删除：</p>
<blockquote>
<p><strong>JavaScript (WEB)</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">block.dispose();</div></pre></td></tr></table></figure></p>
</blockquote>
<p><strong>JAVA (android)</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">blocklyController.removeBlockTree(block);</div></pre></td></tr></table></figure></p>
<p>####可编辑状态<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">block.setEditable(false);  // Web or Android</div></pre></td></tr></table></figure></p>
<p>设置为false时，用户将无法更改块的字段（例如，下拉菜单和文本输入）。块在可编辑工作区上默认为可编辑。</p>
<p>####可移动状态<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">block.setMovable(false);  // Web or Android</div></pre></td></tr></table></figure></p>
<p>当设置为false时，用户将无法直接移动块。作为另一个块的子类的不可移动块可能不会与该块断开连接，但是如果父对象移动，它将与其父对象一起移动。</p>
<p>块在可编辑工作区上默认为可移动</p>
<p>任何块（甚至不可移动块）一旦位于工作空间上，都可以以编程方式移动。在JavaScript中，调用<code>block.moveBy（dx，dy）</code>。除非另有指定，工作空间上块的起始位置默认为（0，0）。</p>
<p>####屏蔽数据（仅限web）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">this.data = &apos;16dcb3a4-bd39-11e4-8dfc-aa07a5b093db&apos;;  // Web only</div></pre></td></tr></table></figure></p>
<p>数据是附加到块的可选且任意的字符串。当保存为XML时，数据字符串存储在<code>&lt;data&gt; &lt;/ data&gt;</code>标签中，以便它可以往回跳回一个块。使用数据字符串将块与外部资源或任何其他自定义目标相关联。</p>
<p>注意，如果块被复制或复制/粘贴，数据字符串也被复制。不可删除的块不能复制或复制/粘贴。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Get-Started---Android" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/12/06/Get-Started---Android/" class="article-date">
      <time datetime="2016-12-06T05:14:15.000Z" itemprop="datePublished">2016-12-06</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <blockquote>
<p>原文地址：<a href="https://developers.google.com/blockly/guides/get-started/android" target="_blank" rel="external">https://developers.google.com/blockly/guides/get-started/android</a></p>
</blockquote>
<p>#开始<br>本指南面向希望创建自己的应用程序并将Blockly作为代码编辑器的Android开发人员。假设他们熟悉Blockly的使用，并且基本了解使用Android Studio的Java和应用程序开发。</p>
<p>主要步骤是：</p>
<ol>
<li>下载并构建库.<a href="https://developers.google.com/blockly/guides/get-started/android#get_the_code" target="_blank" rel="external">Download and build the library</a></li>
<li>创建项目并配置Activity<a href="https://developers.google.com/blockly/guides/get-started/android#create_the_project_and_activity" target="_blank" rel="external">Create the project and configure the activity</a></li>
<li>配置项目的依赖项<a href="https://developers.google.com/blockly/guides/get-started/android#configure_project_dependencies" target="_blank" rel="external">Configure the project’s dependencies</a></li>
<li>扩展AbstractBlocklyActivity并实现必要的方法<a href="https://developers.google.com/blockly/guides/get-started/android#implement_the_activity_base_class" target="_blank" rel="external">Extend AbstractBlocklyActivity</a></li>
</ol>
<p>结果将是你自己的应用程序，看起来像Blockly Simple演示，一个工具箱充满块和一个大工作空间。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-9eb103dd8625e701.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>##Get the Code</p>
<hr>
<p>首先，从GitHub下载源代码。如果您知道如何使用Git或Subversion，我们强烈建议从我们的存储库同步，以便您的代码保持最新<br><a href="https://github.com/google/blockly-android/zipball/master" target="_blank" rel="external">ZIPfile</a><br><a href="https://github.com/google/blockly-android/tarball/master" target="_blank" rel="external">TAR Ball</a><br><a href="https://github.com/google/blockly-android" target="_blank" rel="external">GitHub</a></p>
<p>一旦你有代码，通过导入项目的根目录在Android Studio中打开它。你应该看到四个模块，第一个是blocklydemo。构建并运行<code>blocklydemo</code>以验证您的安装。<br>一旦构建，您会发现以下库文件</p>
<ol>
<li><code>blockly-android/blocklylib-core/build/outputs/aar/blocklylib-core-release.aar</code></li>
<li><code>blockly-android/blocklylib-core/build/outputs/aar/blocklylib-core-debug.aar</code></li>
<li><code>blockly-android/blocklylib-vertical/build/outputs/aar/blocklylib-vertical-release.aar</code></li>
<li><code>blockly-android/blocklylib-vertical/build/outputs/aar/blocklylib-vertical-debug.aar</code></li>
</ol>
<p><code>core</code>文件包括模型和控制器类，以及视图的基类。<code>vertical</code>文件包括垂直堆叠块视图，由VerticalBlockViewFactory和相关的视图类定义。您将在项目中至少包含一个。</p>
<p>##创建项目和Activity</p>
<hr>
<p>如果您还没有应用程序项目，请使用“空活动”模板创建一个。Blockly需要16或更高的minSdkVersion。<br>如果使用现有应用程序，请向项目中添加“”Empty Activity”。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-129cb2be93c54389.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>在任一情况下，您不需要生成带有活动的布局文件。您的块式活动最初将使用Blockly库提供的布局。</p>
<p>在<code>AndroidManifest.xml</code>文件的新<activity>中，将<code>windowSoftInputMode</code>设置如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;application ...    </div><div class="line">      android:windowSoftInputMode=&quot;stateHidden|adjustPan&quot;    </div><div class="line">/&gt;</div></pre></td></tr></table></figure></activity></p>
<p>windowSoftInputMode确保键盘在关闭位置启动，即使有键盘输入字段。它还将确保工作区在键盘（或其他IME）打开时显示此类字段。</p>
<p>在应用程序<code>AppTheme</code>中，在<code>res / values / styles.xml</code>中找到，将父主题设置为<code>BlocklyVerticalTheme</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;style name=&quot;AppTheme&quot; parent=&quot;BlocklyVerticalTheme&quot;&gt;   </div><div class="line">     &lt;!-- Customize your theme here. --&gt;    </div><div class="line">    ...</div><div class="line">&lt;/style&gt;</div></pre></td></tr></table></figure></p>
<p>此父样式配置块和字段的多个默认值。您可以在<a href="https://github.com/google/blockly-android/blob/master/blocklylib-vertical/src/main/res/values/styles.xml" target="_blank" rel="external">the style’s definition</a>中找到更多详细信息。</p>
<p>##Configure project dependencies</p>
<hr>
<p>在应用程序项目中，打开<code>File | Project Structure....</code>确保应用程序模块包含库依赖关系…</p>
<ul>
<li><code>com.android.support:support-v4</code></li>
<li><code>com.android.support:appcompat-v7</code></li>
<li><code>com.android.support:recyclerview-v7</code><br>用项目结构对话框中的“+”按钮将模块添加到项目中。选择“导入.JAR / .AAR软件包”模块模板，并从blockly-android项目目录中选择blocklylib-debug.aar或blocklylib-release.aar。然后，在应用程序模块依赖项中，将新模块添加为模块依赖项。<br><img src="https://developers.google.com/blockly/images/AndroidStudio-AddModule.jpg" alt=""><br>导入这些.aar文件将它们复制到以下位置的项目目录中：</li>
<li><code>MyBlocklyApp/blocklylib-core-debug/blocklylib-core-debug.aar</code></li>
<li><code>MyBlocklyApp/blocklylib-core-release/blocklylib-core-release.aar</code></li>
<li><code>MyBlocklyApp/blocklylib-vertical-debug/blocklylib-vertical-debug.aar</code></li>
<li><code>MyBlocklyApp/blocklylib-vertical-release/blocklylib-vertical-release.aar</code></li>
</ul>
<p>要更新项目中的Blockly库，只需将这些位置的副本替换为较新版本即可。</p>
<p>你可以添加调试和发布版本.aar文件，如果你想只有你的应用程序的调试生成完全调试信息。如果这样做，请确保应用程序模块依赖关系中的范围分别是“Debug compile”和“Release compile”</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-394d0961fc4fb6f4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>##实现活动基类<br><em>*</em>开发Android Blockly活动的最简单的方法是继承<a href="https://github.com/google/blockly-android/blob/master/blocklylib-core/src/main/java/com/google/blockly/android/AbstractBlocklyActivity.java" target="_blank" rel="external">AbstractBlocklyActivity</a>.我们强烈建议您将其用于您的第一个Blockly应用程序。该类有几个抽象方法，你需要重写，详细如下。下面的方法实现了<a href="https://github.com/google/blockly-android/blob/master/blocklydemo/src/main/java/com/google/blockly/android/demo/SimpleActivity.java" target="_blank" rel="external">SimpleActivity</a>中的方法实现，您可以使用它作为参考</p>
<p>#####getToolboxContentsXmlPath()</p>
<p>getBlockDefinitionsJsonPaths（）将assets /目录中的路径返回到块定义.json文件.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">@Override protected String getToolboxContentsXmlPath() &#123;</div><div class="line">    return &quot;default/toolbox.xml&quot;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>#####getBlockDefinitionsJsonPaths()<br>getBlockDefinitionsJsonPaths（）将assets /目录中的路径返回到块定义.json文件。下面的实现导入由Blockly库提供的默认块<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">@Override protected List &lt; String &gt; getBlockDefinitionsJsonPaths() &#123;</div><div class="line">    return Arrays.asList(</div><div class="line">      &quot;default/list_blocks.json&quot;, </div><div class="line">      &quot;default/logic_blocks.json&quot;, </div><div class="line">      &quot;default/loop_blocks.json&quot;,</div><div class="line">      &quot;default/math_blocks.json&quot;, </div><div class="line">      &quot;default/text_blocks.json&quot;, </div><div class="line">      &quot;default/variable_blocks.json&quot;, </div><div class="line">      &quot;default/colour_blocks.json&quot;</div><div class="line">  );</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<blockquote>
<p>注意：有关创建新块的详细信息，请参阅<a href="https://developers.google.com/blockly/guides/configure/android/add-custom-blocks" target="_blank" rel="external">Add Custom Blocks</a>。</p>
</blockquote>
<p>#####getGeneratorsJsPaths()<br>getGeneratorsJsPaths（）将assets /目录中的路径返回到定义块实现的生成器.js文件。当前的实现包括Blockly的默认块的所有JavaScript实现。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">private static final List &lt; String &gt; JAVASCRIPT_GENERATORS = Arrays.asList(</div><div class="line">// Custom block generators go here. Default blocks are already included.</div><div class="line">);</div><div class="line"></div><div class="line">@Override protected List &lt; String &gt; getGeneratorsJsPaths() &#123;</div><div class="line">    return JAVASCRIPT_GENERATORS;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<blockquote>
<p>注意：详细了解使用<a href="https://developers.google.com/blockly/guides/configure/android/custom-generators" target="_blank" rel="external">Use Custom Generators</a>中的生成器。</p>
</blockquote>
<h5 id="getCodeGenerationCallback"><a href="#getCodeGenerationCallback" class="headerlink" title="getCodeGenerationCallback()"></a>getCodeGenerationCallback()</h5><p>getCodeGenerationCallback（）返回用于将生成的代码返回到应用程序的回调。这在用户点击操作栏中的运行/播放按钮后调用。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">CodeGenerationRequest.CodeGeneratorCallback mCodeGeneratorCallback = new LoggingCodeGeneratorCallback(this, &quot;LoggingTag&quot;);</div><div class="line"></div><div class="line">@Override protected CodeGenerationRequest.CodeGeneratorCallback getCodeGenerationCallback() &#123;</div><div class="line">    // Uses the same callback for every generation call.</div><div class="line">    return mCodeGeneratorCallback;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>####onInitBlankWorkspace()<br>虽然不是一个抽象的方法，onInitBlankWorkspace（）是目前需要定义可用的变量，如果你的应用程序包括default / variable_blocks.json。可变支持目前正在开发中。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">@Override protected void onInitBlankWorkspace() &#123;</div><div class="line">    // Initialize available variable names.</div><div class="line">    getController().addVariable(&quot;item&quot;);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>##下一步<br>在这一点上，应用程序应该编译和运行类似于<a href="https://github.com/google/blockly-android/blob/master/blocklydemo/src/main/java/com/google/blockly/android/demo/SimpleActivity.java" target="_blank" rel="external">SimpleActivity
</a>。从这里，发展可以在几个不同的方向前进。您可以…</p>
<ol>
<li><a href="https://developers.google.com/blockly/guides/configure/android/customize-layout" target="_blank" rel="external">Customize the activity layout</a>，为应用程序的导航和/或可视化留出空间。</li>
<li>在新块.json文件中定义和添加自定义块。<a href="https://developers.google.com/blockly/guides/create-custom-blocks/define-blocks" target="_blank" rel="external">Define and add custom blocks</a></li>
<li>自定义工具箱类别和块<a href="https://developers.google.com/blockly/guides/configure/android/toolbox" target="_blank" rel="external">Customize the toolbox categories and blocks</a></li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-创建自定义块---生成代码" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/12/06/创建自定义块---生成代码/" class="article-date">
      <time datetime="2016-12-06T05:14:15.000Z" itemprop="datePublished">2016-12-06</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>Create Custom BlocksGenerating Code</p>
<blockquote>
<p>原文链接：<a href="https://developers.google.com/blockly/guides/create-custom-blocks/generating-code" target="_blank" rel="external">https://developers.google.com/blockly/guides/create-custom-blocks/generating-code</a></p>
</blockquote>
<p>大多数Blockly应用程序需要将块转换为代码以供执行。本页介绍如何向自定义块添加代码生成器。</p>
<p>首先，转到generators /目录并选择与要生成的语言（JavaScript，Python，PHP，Lua，Dart等）对应的子目录。假设您的块不适合现有类别，请创建一个新的JavaScript文件。这个新的JavaScript文件需要包含在编辑器的HTML文件中的<script ...="">标签列表中。</p>
<p>典型的块的代码生成器如下所示<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">Blockly.JavaScript[&apos;text_indexOf&apos;] = function(block) &#123;</div><div class="line">  // Search the text for a substring.</div><div class="line">  var operator = block.getFieldValue(&apos;END&apos;) == &apos;FIRST&apos; ? &apos;indexOf&apos; : &apos;lastIndexOf&apos;;</div><div class="line">  var subString = Blockly.JavaScript.valueToCode(block, &apos;FIND&apos;,</div><div class="line">      Blockly.JavaScript.ORDER_NONE) || &apos;\&apos;\&apos;&apos;;</div><div class="line">  var text = Blockly.JavaScript.valueToCode(block, &apos;VALUE&apos;,</div><div class="line">      Blockly.JavaScript.ORDER_MEMBER) || &apos;\&apos;\&apos;&apos;;</div><div class="line">  var code = text + &apos;.&apos; + operator + &apos;(&apos; + subString + &apos;)&apos;;</div><div class="line">  return [code, Blockly.JavaScript.ORDER_MEMBER];</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>##收集参数 </p>
<hr>
<p>任何块的代码生成器的第一个任务是收集所有的参数和字段数据。这个任务通常有几个函数：</p>
<ul>
<li><a href="https://developers.google.com/blockly/guides/create-custom-blocks/generating-code#getfieldvalue">getFieldValue</a></li>
<li><a href="https://developers.google.com/blockly/guides/create-custom-blocks/generating-code#valuetocode">valueToCode</a></li>
<li><a href="https://developers.google.com/blockly/guides/create-custom-blocks/generating-code#statementtocode">statementToCode</a></li>
</ul>
<p>####getFieldValue<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">block.getFieldValue(&apos;END&apos;)</div></pre></td></tr></table></figure></p>
<p>此函数从指定名称的字段返回值。</p>
<ul>
<li>在文本字段的情况下，此函数返回键入的文本。例如。 “Hello World”。</li>
<li>在下拉列表的情况下，此函数返回与所选选项相关联的与语言无关的文本。英语块可能有一个下拉菜单，选择了“first”，而德语中的下拉菜单将显示“erste”。代码生成器不必知道所有可能的人类语言，因此getFieldValue函数将返回创建下拉列表时指定的语言中性文本（Blockly的核心块通常使用大写英语单词，例如“FIRST”）。</li>
<li>在变量下拉的情况下，此函数返回变量下拉的面向用户的名称。请注意，此名称不一定与生成的代码中使用的变量名称相同。例如，变量名“for”在Blockly中是合法的，但是在大多数语言中将与保留字冲突，因此将被重命名为“for2”。同样，阿拉伯语变量名“متغير”在Blockly中是合法的，但在大多数语言中是非法的，因此将被重命名为“_D9_85_D8_AA_D8_BA_D9_8A_D8_B1”。要获取Blockly变量名称为可用于生成代码的变量名称，请使用以下调用：<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Blockly.JavaScript.variableDB_.getName(block.getFieldValue(&apos;VAR&apos;), Blockly.Variables.NAME_TYPE);</div></pre></td></tr></table></figure>
</li>
</ul>
<p>请注意，JavaScript应该更改为适当的语言（Python，PHP，Lua，Dart等），因为每种语言都有不同的保留字列表。</p>
<p>####valueToCode<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Blockly.JavaScript.valueToCode(block, &apos;FROM&apos;, Blockly.JavaScript.ORDER_ADDITION) || &apos;0&apos;</div></pre></td></tr></table></figure></p>
<p>此函数查找连接到命名值输入（“FROM”）的块，生成该块的代码，并将该代码作为字符串返回。如果输入未连接，则此函数返回null，这就是为什么通常使用布尔值“或”和默认值跟随函数的原因。因此，在上面的示例中，如果没有块附加到名为“FROM”的输入，则此输入的默认代码将为字符串’0’。</p>
<p>第三个参数指定嵌入所需的操作信息的顺序。每个语言生成器都有一个有序的优先级列表。 valueToCode函数需要传递对应于将应用于返回的代码的最大力的顺序值。这允许valueToCode根据需要将代码括在括号中。有关详细信息，请参阅运营商优先级页面<a href="https://developers.google.com/blockly/guides/create-custom-blocks/operator-precedence">operator precedence</a>。</p>
<p>请注意，JavaScript应该更改为适当的语言（Python，PHP，Lua，Dart等）。</p>
<p>####statementToCode<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Blockly.JavaScript.statementToCode(block, &apos;DO&apos;)</div></pre></td></tr></table></figure></p>
<p>此函数查找连接到指定语句输入的嵌套块的堆栈，生成该堆栈的代码，缩进代码，并将代码作为字符串返回。如果输入未连接，则此函数返回一个空字符串。<br>请注意，JavaScript应该更改为适当的语言（Python，PHP，Lua，Dart等）。</p>
<p>##组装代码</p>
<hr>
<p>一旦收集了所有参数，就可以组合最终的代码。这对于大多数块是直接的。这里是一个while循环的例子<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var code = &apos;while (&apos; + argument0 + &apos;) &#123;\n&apos; + branch0 + &apos;&#125;\n&apos;;</div></pre></td></tr></table></figure></p>
<p>语句块（不返回值的那些块）然后可以返回代码，而不用费心：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">return code;</div></pre></td></tr></table></figure></p>
<p>值块（返回值的那些块）有点复杂。这里是一个基本算术运算符（加号，减号等）的例子：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var code = argument0 + &apos; &apos; + operator + &apos; &apos; + argument1;</div></pre></td></tr></table></figure></p>
<p>此示例说明了操作顺序问题。考虑形成表达式（2 <em>（3 + 4））的两个连接的算术块的情况。使用上述代码剪切，加法块将返回字符串“3 + 4”，而乘法块将使用其作为输入以返回“2 </em> 3 + 4”。这个结果是不正确的，因为执行时3将更紧密地绑定到乘法。</p>
<p>为了解决这个问题，值块必须返回一个包含两个值的列表：代码和适当的顺序值：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">return [code, Blockly.JavaScript.ORDER_ADDITION];</div></pre></td></tr></table></figure></p>
<p>每个语言生成器都有一个有序的优先级列表。返回的顺序值指定将代码绑定在一起的最小强制。有关详细信息，请参阅运营商优先级页面<a href="https://developers.google.com/blockly/guides/create-custom-blocks/operator-precedence">operator precedence</a>。</p>
<p>如果生成的代码要求子块的代码被包括两次，则应该缓存参数<a href="https://developers.google.com/blockly/guides/create-custom-blocks/caching-arguments">cache the arguments</a>以提高效率并防止副作用。</p>
</script></p>
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-创建自定义块---类型检查" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/12/06/创建自定义块---类型检查/" class="article-date">
      <time datetime="2016-12-06T05:14:15.000Z" itemprop="datePublished">2016-12-06</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>Type Checks<br>&lt;原文地址：<a href="https://developers.google.com/blockly/guides/create-custom-blocks/type-checks" target="_blank" rel="external">https://developers.google.com/blockly/guides/create-custom-blocks/type-checks</a></p>
<p>Blockly建模动态类型语言（如JavaScript或Python）。它缺少静态类型语言（如Java或C ++）的严格规则。更具体地说，任何值都可以赋给任何变量，在变量定义中没有int，bool或float。</p>
<p>然而，Blockly确实有能力防止一些没联系(non-sensical combinations )组合的构建。以下三个块没有业务相互连接：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-ab2461633ade1543.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br>每个Blockly的连接类型（值输入/输出，下一个/上一个语句）都可以用类型信息标记，以使明显无效的连接将拒绝连接。这给用户即时的反馈，并避免许多简单的错误。</p>
<p>##值输入和输出</p>
<hr>
<p>让我们从一个数字块开始。当指定输出时，也可以设置类型字符串。因为这个块应该返回一个数字，让我们将输出类型设置为字符串’Number’：</p>
<blockquote>
<p><strong>json</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&#123;  </div><div class="line">    &quot;type&quot;: &quot;math_number&quot;,  </div><div class="line">    // ...  </div><div class="line">    &quot;output&quot;: &quot;Number&quot;,</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p><strong>js</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Blockly.Blocks[&apos;math_number&apos;] = &#123;</div><div class="line">  init: function() &#123;</div><div class="line">    // ...</div><div class="line">    this.setOutput(true, &apos;Number&apos;);</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-d987728b5f3bb201.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>更复杂的块是确定数字是否为偶数的数学块。这个块有一个期望一个数字的输入，和一个返回一个布尔的输出。这里是指定这样的代码：</p>
<blockquote>
<p><strong>json</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &quot;type&quot;: &quot;math_number_property&quot;,</div><div class="line">  // ...</div><div class="line">  &quot;args0&quot;: [</div><div class="line">      // ...</div><div class="line">      &#123;</div><div class="line">        &quot;type&quot;: &quot;input_value&quot;,</div><div class="line">        &quot;name&quot;: &quot;NUMBER_TO_CHECK&quot;,</div><div class="line">        &quot;check&quot;: &quot;Number&quot;</div><div class="line">      &#125;</div><div class="line">  ],</div><div class="line">  &quot;output&quot;: &quot;Boolean&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p><strong>js</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Blockly.Blocks[&apos;math_number_property&apos;] = &#123;</div><div class="line">  init: function() &#123;</div><div class="line">    // ...</div><div class="line">    this.appendValueInput(&apos;NUMBER_TO_CHECK&apos;).setCheck(&apos;Number&apos;);</div><div class="line">    this.setOutput(true, &apos;Boolean&apos;);</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-4248d29804ffcdbd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>当数字块连接到此数学块时，两个连接的类型都为“Number”，因此连接成功。而如果一个人试图将一个文本块（输出类型为’String’）插入数学块，那么这两种类型将不匹配，并且连接将拒绝连接。</p>
<p>“ength of”类似，除了它需要能够接受文本块或列表块。因此，不是一个字符串，它的输入类型被设置为两个选项的数组：</p>
<blockquote>
<p><strong>json</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &quot;type&quot;: &quot;text_length&quot;,</div><div class="line">  // ...</div><div class="line">  &quot;args0&quot;: [</div><div class="line">      // ...</div><div class="line">      &#123;</div><div class="line">        &quot;type&quot;: &quot;input_value&quot;,</div><div class="line">        &quot;name&quot;: &quot;VALUE&quot;,</div><div class="line">        &quot;check&quot;: [&quot;String&quot;, &quot;Array&quot;]</div><div class="line">      &#125;</div><div class="line">  ],</div><div class="line">  &quot;output&quot;: &quot;Number&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p><strong>js</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Blockly.Blocks[&apos;text_length&apos;] = &#123;</div><div class="line">  init: function() &#123;</div><div class="line">    // ...</div><div class="line">    this.appendValueInput(&apos;VALUE&apos;).setCheck([&apos;String&apos;, &apos;Array&apos;]);</div><div class="line">    this.setOutput(true, &apos;Number&apos;);</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-6433533aeebb3742.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br>块可以想象地返回两种或更多种类型中的一种。虽然在Blockly中没有当前的例子，但是通过将输出类型设置为类型数组来支持。如果输入中的任何单个类型与输出中的类型匹配，则可以连接块。</p>
<p>变量是可以保存任何类型的值块的示例。因此，它们的类型设置为null，表示通配符：</p>
<blockquote>
<p><strong>json</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &quot;type&quot;: &quot;variable_get&quot;,</div><div class="line">  // ...</div><div class="line">  &quot;output&quot;: null</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p><strong>js</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Blockly.Blocks[&apos;variable_get&apos;] = &#123;</div><div class="line">  init: function() &#123;</div><div class="line">    // ...</div><div class="line">    // Second parameter for type is optional, and null is the default.</div><div class="line">    this.setOutput(true);</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-50cc9da3efb2e589.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br>允许将块插入任何输入，而不管输入的类型。</p>
<p>请注意，Blockly（’Number’，’Boolean’，’String’，’Array’，’Color’）中使用的类型字符串是完全任意的。任何字符串都是可接受的，并且新的字符串可以是专门的。只是确保输出和输入之间的一致性。</p>
<p>##语句堆栈</p>
<hr>
<p>以与输入和输出的水平连接可以类型相同的方式，垂直语句堆栈也可以具有类型信息。大多数编码应用程序不会使用此功能，因为任何语句通常可以遵循任何其他语句。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-ef1d4b9f438bfb09.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>类型语句连接的一个罕见示例可以在Blockly开发工具的Block Factory选项卡中看到。注意，字段块可以不被堆叠在输入块应该去的地方，并且输入块可以不被堆叠在字段块应该去的地方。</p>
<p>有三个地方定义了类型化语句：一个块的上一个和下一个连接，以及一个语句输入的连接。它们定义块的顶部和底部的堆叠槽口，它们只能连接到其槽口未设置类型或其槽口包含至少一个匹配类型的块。</p>
<p>以下示例演示“Mouse”和“Rat”类型，其中可以将任一类型的块添加到语句输入RODENTS。然而，这个玩具例子不支持啮齿动物列表中的老鼠和鼠。</p>
<blockquote>
<p><strong>json</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &quot;type&quot;: &quot;append_mouse&quot;,</div><div class="line">  &quot;message0&quot;: &quot;Mouse&quot;,</div><div class="line">  &quot;previousStatement&quot;: &quot;Mouse&quot;,</div><div class="line">  &quot;nextStatement&quot;: &quot;Mouse&quot;</div><div class="line">&#125;,</div><div class="line">&#123;</div><div class="line">  &quot;type&quot;: &quot;rodent_list&quot;,</div><div class="line">  &quot;message0&quot;: &quot;Rodents %1&quot;,</div><div class="line">  &quot;args0&quot;: [</div><div class="line">      &#123;</div><div class="line">        &quot;type&quot;: &quot;input_statement&quot;,</div><div class="line">        &quot;name&quot;: &quot;RODENTS&quot;,</div><div class="line">        &quot;check&quot;: [&quot;Mouse&quot;, &quot;Rat&quot;]</div><div class="line">      &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p><strong>js</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">Blockly.Blocks[&apos;append_mouse&apos;] = &#123;</div><div class="line">  init: function() &#123;</div><div class="line">    this.appendDummyInput().appendField(&apos;Mouse&apos;);</div><div class="line">    this.setPreviousStatement(true, &apos;Mouse&apos;);</div><div class="line">    this.setNextStatement(true, &apos;Mouse&apos;);</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line">Blockly.Blocks[&apos;rodent_list&apos;] = &#123;</div><div class="line">  init: function() &#123;</div><div class="line">    this.appendDummyInput().appendField(&apos;Rodents&apos;);</div><div class="line">    this.appendStatementInput(&apos;RODENTS&apos;)</div><div class="line">        .setCheck([&apos;Mouse&apos;, &apos;Rat&apos;]);</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-9a6d9f5fad40cd3f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-创建自定义块---缓存参数" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/12/06/创建自定义块---缓存参数/" class="article-date">
      <time datetime="2016-12-06T05:14:15.000Z" itemprop="datePublished">2016-12-06</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>##Caching Arguments<br>当从块生成代码时，经常发现需要多次使用子块的返回值。考虑一个值块，它找到并返回一个列表的最后一个元素。块本身将有一个输入（一个列表），并且将返回一个值（最后一个元素）。这里是JavaScript的生成器：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var code = arg0 + &apos;[&apos; + arg0 + &apos;.length - 1]&apos;;</div></pre></td></tr></table></figure></p>
<p>如果arg0是一个变量名，这个生成器返回完全可以接受的JavaScript：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">aList[aList.length - 1]</div></pre></td></tr></table></figure></p>
<p>然而，如果arg0是一个函数调用，这个生成器可能有意想不到的行为。考虑下面的代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">randomList()[randomList().length - 1]</div></pre></td></tr></table></figure></p>
<p>两个返回的值可能具有不同的长度，导致超出范围条件。此外，如果函数调用有副作用，则调用它两次可能是不希望的。<br>这个问题有两个解决方案。语句块应使用临时变量。值块应使用效用函数。</p>
<p>##临时变量</p>
<hr>
<p>最简单的解决方案是将违规输入分配给临时变量。必须注意，此变量不会意外地与现有变量碰撞。下面的代码显示了语句块中临时变量的示例，它提示列表的最后一个元素。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">var listVar = Blockly.JavaScript.variableDB_.getDistinctName(</div><div class="line">    &apos;temp_list&apos;, Blockly.Variables.NAME_TYPE);</div><div class="line">var code = &apos;var &apos; + listVar + &apos; = &apos; + arg0 + &apos;;\n&apos;;</div><div class="line">code += &apos;alert(&apos; + listVar + &apos;[&apos; + listVar + &apos;.length - 1]);\n&apos;;</div></pre></td></tr></table></figure></p>
<p><code>getDistinctName</code>调用接受所需变量名（“temp_list”）的参数，并返回一个非冲突的名称（可能是“temp_list2”）。<br>临时变量的缺点是，如果违规输入已经是一个变量，那么会生成冗余代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">var temp_list = foo;</div><div class="line">alert(temp_list[temp_list.length - 1]);</div></pre></td></tr></table></figure></p>
<p>要生成更干净的代码，请检查违规输入是否是一个简单的文字，并相应地生成代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">if (arg0.match(/^\w+$/)) &#123;</div><div class="line">  var code = &apos;alert(&apos; + arg0 + &apos;[&apos; + arg0 + &apos;.length - 1]);\n&apos;;</div><div class="line">&#125; else &#123;</div><div class="line">  var listVar = Blockly.JavaScript.variableDB_.getDistinctName(</div><div class="line">      &apos;temp_list&apos;, Blockly.Variables.NAME_TYPE);</div><div class="line">  var code = &apos;var &apos; + listVar + &apos; = &apos; + arg0 + &apos;;\n&apos;;</div><div class="line">  code += &apos;alert(&apos; + listVar + &apos;[&apos; + listVar + &apos;.length - 1]);\n&apos;;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>有关临时变量的工作示例，请参见Blockly.JavaScript.controls_forEach。</p>
<p>临时变量在语句块（在这种情况下是警报）中工作良好，其中生成的代码可能跨越多行。然而，它们在值块中不可行，这些值块必须在单行上。对于值块，必须使用效用函数而不是临时变量。</p>
<p>##Utility Functions(?效用函数)</p>
<hr>
<p>定义效用函数是创建在比底层语言更高级别上操作的块的有效方式。除非使用效用函数，否则不会生成效用函数，并且它们只生成一次，而不考虑它们的使用次数。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">var functionName = Blockly.JavaScript.provideFunction_(</div><div class="line">    &apos;list_lastElement&apos;,</div><div class="line">    [ &apos;function &apos; + Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_ + &apos;(aList) &#123;&apos;,</div><div class="line">      &apos;  // Return the last element of a list.&apos;,</div><div class="line">      &apos;  return aList[aList.length - 1];&apos;,</div><div class="line">      &apos;&#125;&apos;]);</div><div class="line">// Generate the function call for this block.</div><div class="line">var code = functionName + &apos;(&apos; + arg0 + &apos;)&apos;;</div><div class="line">return [code, Blockly.JavaScript.ORDER_FUNCTION_CALL];</div></pre></td></tr></table></figure></p>
<p>在上面的例子中，我们请求定义一个名为list_lastElement的实用函数（尽管实际名称可能不同，以避免与用户变量冲突）。有关效用函数的工作示例，请参见<code>Blockly.JavaScript.text_endString</code>。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-创建自定义块---运算符优先级" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/12/06/创建自定义块---运算符优先级/" class="article-date">
      <time datetime="2016-12-06T05:14:15.000Z" itemprop="datePublished">2016-12-06</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>代码生成器用于将Blockly的程序转换为JavaScript，Python，PHP，Lua，Dart等。为新块创建代码生成器时最具挑战性的问题是处理操作的顺序，以便生成的代码按预期执行。</p>
<p>##坑爹的括号</p>
<hr>
<p>考虑以下块的装配。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-32012dce96818708.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>如果生成器不知道运算符优先级，则生成的JavaScript代码将是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">alert(2 * 3 + 4);</div></pre></td></tr></table></figure></p>
<p>这显然是不正确的，因为乘法运算符分割加法，先乘以3。一个解决方案是将每个值块的结果包裹在括号中：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">alert(((2) * ((3) + (4)));</div></pre></td></tr></table></figure></p>
<p>这个解决方案完美地工作，但它导致非常凌乱的代码与大量的冗余括号。对于一些使用情况，这不是一个问题。如果人眼永远不会看到生成的代码，那么这是可以接受的。但是，Blockly经常被用作介绍编程的教育工具，一种依赖于生成人类可读代码的用例。</p>
<p>##Good Parentheses</p>
<hr>
<p>为了生成没有不合理数量的括号的正确代码，每个语言生成器都提供了有序的优先级列表。这里是JavaScript的列表：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">Blockly.JavaScript.ORDER_ATOMIC = 0;         // 0 &quot;&quot; ...</div><div class="line">Blockly.JavaScript.ORDER_MEMBER = 1;         // . []</div><div class="line">Blockly.JavaScript.ORDER_NEW = 1;            // new</div><div class="line">Blockly.JavaScript.ORDER_FUNCTION_CALL = 2;  // ()</div><div class="line">Blockly.JavaScript.ORDER_INCREMENT = 3;      // ++</div><div class="line">Blockly.JavaScript.ORDER_DECREMENT = 3;      // --</div><div class="line">Blockly.JavaScript.ORDER_LOGICAL_NOT = 4;    // !</div><div class="line">Blockly.JavaScript.ORDER_BITWISE_NOT = 4;    // ~</div><div class="line">Blockly.JavaScript.ORDER_UNARY_PLUS = 4;     // +</div><div class="line">Blockly.JavaScript.ORDER_UNARY_NEGATION = 4; // -</div><div class="line">Blockly.JavaScript.ORDER_TYPEOF = 4;         // typeof</div><div class="line">Blockly.JavaScript.ORDER_VOID = 4;           // void</div><div class="line">Blockly.JavaScript.ORDER_DELETE = 4;         // delete</div><div class="line">Blockly.JavaScript.ORDER_MULTIPLICATION = 5; // \*</div><div class="line">Blockly.JavaScript.ORDER_DIVISION = 5;       // /</div><div class="line">Blockly.JavaScript.ORDER_MODULUS = 5;        // %</div><div class="line">Blockly.JavaScript.ORDER_ADDITION = 6;       // +</div><div class="line">Blockly.JavaScript.ORDER_SUBTRACTION = 6;    // -</div><div class="line">Blockly.JavaScript.ORDER_BITWISE_SHIFT = 7;  // &lt;&lt; &gt;&gt; &gt;&gt;&gt;</div><div class="line">Blockly.JavaScript.ORDER_RELATIONAL = 8;     // &lt; &lt;= &gt; &gt;=</div><div class="line">Blockly.JavaScript.ORDER_IN = 8;             // in</div><div class="line">Blockly.JavaScript.ORDER_INSTANCEOF = 8;     // instanceof</div><div class="line">Blockly.JavaScript.ORDER_EQUALITY = 9;       // == != === !==</div><div class="line">Blockly.JavaScript.ORDER_BITWISE_AND = 10;   // &amp;</div><div class="line">Blockly.JavaScript.ORDER_BITWISE_XOR = 11;   // ^</div><div class="line">Blockly.JavaScript.ORDER_BITWISE_OR = 12;    // |</div><div class="line">Blockly.JavaScript.ORDER_LOGICAL_AND = 13;   // &amp;&amp;</div><div class="line">Blockly.JavaScript.ORDER_LOGICAL_OR = 14;    // ||</div><div class="line">Blockly.JavaScript.ORDER_CONDITIONAL = 15;   // ?:</div><div class="line">Blockly.JavaScript.ORDER_ASSIGNMENT = 16;    // = += -= \*= /= %= &lt;&lt;= &gt;&gt;= ...</div><div class="line">Blockly.JavaScript.ORDER_COMMA = 17;         // ,</div><div class="line">Blockly.JavaScript.ORDER_NONE = 99;          // (...)</div></pre></td></tr></table></figure></p>
<p>此列表的大部分直接取自JavaScript的语言规范<a href="https://developer.mozilla.org/en/JavaScript/Reference/Operators/Operator_Precedence" target="_blank" rel="external">language spec</a>，其中ORDER_ATOMIC添加到开始，ORDER_NONE添加到结尾。</p>
<p>应用这些规则会在每个块的生成器中的两个地方使用到。第一个地方是从连接的值块获取生成的代码。在这种情况下，我们传递常数，该常数表示与子块生成的代码相邻的任何运算符的最大绑定强度。例如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var arg0 = Blockly.JavaScript.valueToCode(this, &apos;NUM1&apos;, Blockly.JavaScript.ORDER_DIVISION);</div></pre></td></tr></table></figure></p>
<p>第二个是从值块返回生成的代码。在这种情况下，我们传递常量，它代表块生成代码中任何运算符的最小绑定强度。例如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">return [arg0 + &apos; / &apos; + arg1, Blockly.JavaScript.ORDER_DIVISION];</div></pre></td></tr></table></figure></p>
<p>如果子块返回的顺序值弱于或等于父块的顺序参数的顺序值，那么valueToCode函数将自动将子块代码的内容括在括号中，以防止它由父块的代码割裂开。</p>
<p>下面是一些更多的例子。在每种情况下，块具有被表示为“X”的一个连接子块（’X’的内容是未知的并且无关紧要）。第二列列出可能分裂“X”的最强运算符。第三列列出了块的最终代码中最弱的运算符。</p>
<table>
<thead>
<tr>
<th>生成的代码</th>
<th style="text-align:center"><strong>Max strength against X</strong></th>
<th style="text-align:right">Min strength of block</th>
</tr>
</thead>
<tbody>
<tr>
<td>X + 1</td>
<td style="text-align:center">ORDER_ADDITION</td>
<td style="text-align:right">ORDER_ADDITION</td>
</tr>
<tr>
<td>Math.sqrt(X)</td>
<td style="text-align:center">ORDER_NONE</td>
<td style="text-align:right">ORDER_MEMBER</td>
</tr>
<tr>
<td>!X &amp;&amp; false</td>
<td style="text-align:center">ORDER_LOGICAL_NOT</td>
<td style="text-align:right">ORDER_LOGICAL_AND</td>
</tr>
<tr>
<td>foo[X % 60]</td>
<td style="text-align:center">ORDER_MODULUS</td>
<td style="text-align:right">ORDER_MEMBER</td>
</tr>
</tbody>
</table>
<p>##数学很难</p>
<hr>
<p>还是不明白？没问题。只需使用ORDER_ATOMIC作为每次调用valueToCode的顺序，并使用ORDER_NONE作为每个值块上最终返回语句的顺序。结果代码将被不必要的括号侵蚀，但是保证是正确的。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-应用程序集成---生成和运行Javascript" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/12/06/应用程序集成---生成和运行Javascript/" class="article-date">
      <time datetime="2016-12-06T05:14:15.000Z" itemprop="datePublished">2016-12-06</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>Generating and Running Javascript</p>
<blockquote>
<p>原文:<a href="https://developers.google.com/blockly/guides/app-integration/running-javascript" target="_blank" rel="external">https://developers.google.com/blockly/guides/app-integration/running-javascript</a></p>
</blockquote>
<p>阻止应用程序经常生成JavaScript作为其输出语言，通常在Web页面（可能是相同的，或嵌入式WebView）中运行。像任何生成器，第一步是包括javascript生成器。</p>
<p>对于Web Blockly，包括<code>javascript_compressed.js</code>，紧接着<code>blockly_compressed.js</code>：</p>
<blockquote>
<p><strong>WEB</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;script src=&quot;blockly_compressed.js&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;script src=&quot;javascript_compressed.js&quot;&gt;&lt;/script&gt;</div></pre></td></tr></table></figure></p>
</blockquote>
<p>要从工作区生成JavaScript，请调用：</p>
<blockquote>
<p><strong>WEB</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Blockly.JavaScript.addReservedWords(&apos;code&apos;);</div><div class="line">var code = Blockly.JavaScript.workspaceToCode(workspace);</div></pre></td></tr></table></figure></p>
</blockquote>
<p>Blockly for Android生成JavaScript默认情况下，不应该需要配置。有关详细信息，请参阅使用自定义JavaScript生成器<a href="https://developers.google.com/blockly/guides/configure/android/custom-generators" target="_blank" rel="external">Using custom JavaScript Generators</a>。</p>
<p>生成的代码可以在目标网页中执行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">try &#123;</div><div class="line">  eval(code);</div><div class="line">&#125; catch (e) &#123;</div><div class="line">  alert(e);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>基本上，上面的代码片段只是生成代码和evals它。然而，有几个细化。一个细化是eval包裹在一个try / catch，以便任何运行时错误是可见的，而不是安静地失败。另一个细化是将代码添加到保留字列表，以便如果用户的代码包含该名称的变量，它将被自动重命名，而不是冲突。任何局部变量都应该以这种方式保留。</p>
<p>##突出显示块（仅限Web）</p>
<hr>
<p>在同一页面中运行代码的Web应用程序通常包括在代码运行时突出显示当前执行的块。这可以通过在生成JavaScript代码之前设置STATEMENT_PREFIX，逐个语句级完成：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Blockly.JavaScript.STATEMENT_PREFIX = &apos;highlightBlock(%1);\n&apos;;</div><div class="line">Blockly.JavaScript.addReservedWords(&apos;highlightBlock&apos;);</div></pre></td></tr></table></figure></p>
<p>定义highlightBlock以标记工作区上的块。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">function highlightBlock(id) &#123;</div><div class="line">  workspace.highlightBlock(id);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>这将导致语句highlightBlock（’123’）;被添加到每个语句之前，其中123是要突出显示的块的序列号。</p>
<p>##无限循环</p>
<hr>
<p>虽然结果代码在任何时候都保证在语法上是正确的，但它可能包含无限循环。由于求解Halting问题<a href="https://en.wikipedia.org/wiki/Halting_problem" target="_blank" rel="external">Halting problem</a>超出了Blockly的范围（！），处理这些情况的最佳方法是保持计数器并在每次执行迭代时递减计数器。要完成这一点，只需将Blockly.JavaScript.INFINITE_LOOP_TRAP设置为一个代码片段，它将被插入到每个循环和每个函数。这里是一个例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">window.LoopTrap = 1000;</div><div class="line">Blockly.JavaScript.INFINITE_LOOP_TRAP = &apos;if(--window.LoopTrap == 0) throw &quot;Infinite loop.&quot;;\n&apos;;</div><div class="line">var code = Blockly.JavaScript.workspaceToCode(workspace);</div></pre></td></tr></table></figure>
<p>##例子</p>
<hr>
<p>如果你认真正确地运行用户的块，那么JS解释器项目是必须要走的路。这个项目与Blockly分开，但是专门为Blockly写的。</p>
<ul>
<li>以任何速度执行代码</li>
<li>暂停/恢复/逐步执行。 </li>
<li>突出显示块执行时。 </li>
<li>完全隔离浏览器的JS。<br>这里是使用Blockly和JS Interpreter生成和执行JavaScript的现场演示<a href="https://blockly-demo.appspot.com/static/demos/generator/index.html" target="_blank" rel="external">a live demo</a>。</li>
</ul>
<p>####运行解释器<br>首先，从GitHub下载JS解释器：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-7300439ad3503e87.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br><a href="https://github.com/NeilFraser/JS-Interpreter/zipball/master" target="_blank" rel="external">ZIP File</a><br><a href="https://github.com/NeilFraser/JS-Interpreter/tarball/master" target="_blank" rel="external">TAR Ball</a><br><a href="https://github.com/NeilFraser/JS-Interpreter" target="_blank" rel="external">GitHub</a></p>
<p>然后将其添加到您的网页：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;script src=&quot;acorn_interpreter.js&quot;&gt;&lt;/script&gt;</div></pre></td></tr></table></figure></p>
<p>调用它的最简单的方法是生成JavaScript，创建解释器，并运行代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var code = Blockly.JavaScript.workspaceToCode(workspace);</div><div class="line">var myInterpreter = new Interpreter(code);</div><div class="line">myInterpreter.run();</div></pre></td></tr></table></figure></p>
<p>####单步解释（Step the Interpreter）<br>为了更慢地或以更受控的方式执行代码，将调用替换为使用循环执行的调用（在这种情况下每10ms一步）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">function nextStep() &#123;</div><div class="line">  if (myInterpreter.step()) &#123;</div><div class="line">    window.setTimeout(nextStep, 10);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">nextStep();</div></pre></td></tr></table></figure></p>
<p>注意，每个步骤不是一行或一个块，它是JavaScript中的语义单元，它可能是非常细粒度的。</p>
<p>####添加API<br>JS解释器是一个与浏览器完全隔离的沙盒。任何对外界执行操作的块都需要向解释器添加API。有关完整说明，请参阅<a href="https://neil.fraser.name/software/JS-Interpreter/docs.html" target="_blank" rel="external">JS-Interpreter documentation</a>文档。但首先，这里是需要支持警报和提示块的API：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">function initApi(interpreter, scope) &#123;</div><div class="line">  // Add an API function for the alert() block.</div><div class="line">  var wrapper = function(text) &#123;</div><div class="line">    text = text ? text.toString() : &apos;&apos;;</div><div class="line">    return interpreter.createPrimitive(alert(text));</div><div class="line">  &#125;;</div><div class="line">  interpreter.setProperty(scope, &apos;alert&apos;,</div><div class="line">      interpreter.createNativeFunction(wrapper));</div><div class="line"></div><div class="line">  // Add an API function for the prompt() block.</div><div class="line">  wrapper = function(text) &#123;</div><div class="line">    text = text ? text.toString() : &apos;&apos;;</div><div class="line">    return interpreter.createPrimitive(prompt(text));</div><div class="line">  &#125;;</div><div class="line">  interpreter.setProperty(scope, &apos;prompt&apos;,</div><div class="line">      interpreter.createNativeFunction(wrapper));</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>然后修改您的解释器初始化以传入initApi函数：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var myInterpreter = new Interpreter(code, initApi);</div></pre></td></tr></table></figure></p>
<p>警告和提示块是缺省的块集中只有需要为解释器定制API的两个块。</p>
<p>####正在连接highlightBlock（）<br>当在JS解释器中运行时，在用户逐步浏览程序时，highlightBlock（）应该立即在沙盒外执行。为此，创建一个包装器函数highlightBlock（）来捕获函数参数，并将其注册为本机函数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">function initApi(interpreter, scope) &#123;</div><div class="line">  // Add an API function for highlighting blocks.</div><div class="line">  var wrapper = function(id) &#123;</div><div class="line">    id = id ? id.toString() : &apos;&apos;;</div><div class="line">    return interpreter.createPrimitive(workspace.highlightBlock(id));</div><div class="line">  &#125;;</div><div class="line">  interpreter.setProperty(scope, &apos;highlightBlock&apos;,</div><div class="line">      interpreter.createNativeFunction(wrapper));</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>更复杂的应用程序可能希望重复执行步骤而不暂停，直到达到突出显示命令，然后暂停。此策略模拟逐行执行。下面的示例使用此方法。</p>
<p>####JS解释器示例<br>这里是一步一步解释JavaScript的现场演示<a href="https://blockly-demo.appspot.com/static/demos/interpreter/index.html" target="_blank" rel="external">a live demo</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-百度" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/12/06/百度/" class="article-date">
      <time datetime="2016-12-06T05:14:15.000Z" itemprop="datePublished">2016-12-06</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p><img src="http://upload-images.jianshu.io/upload_images/2433593-0b28b0dd18606908.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="临摹"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-应用程序集成---自定义块：最佳实践" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/12/06/应用程序集成---自定义块：最佳实践/" class="article-date">
      <time datetime="2016-12-06T05:14:15.000Z" itemprop="datePublished">2016-12-06</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>Custom Blocks: Best Practices</p>
<blockquote>
<p>原文：<a href="https://developers.google.com/blockly/guides/app-integration/best-practices" target="_blank" rel="external">https://developers.google.com/blockly/guides/app-integration/best-practices</a></p>
</blockquote>
<p>多年来，Blockly和Blockly Games团队学到了许多适用于那些开发基于Blockly的应用程序的课程。以下是我们所犯错误的集合，或者他人通常犯的错误。</p>
<p>这些是我们使用Blockly的视觉风格学到的一般教训，可能不适用于所有用例或设计。可能存在其他解决方案。这也不是用户可能遇到的问题和如何避免他们的问题的详尽列表。每个案例都有点不同，可能有自己的权衡。</p>
<p>##1. 边框样式</p>
<hr>
<p>在21世纪初，“Aqua”的外观是主流的，每个屏幕上的对象都装饰着突出和阴影。在2010年的“材料设计”外观是流行的，每个屏幕对象简化为一个干净，平坦，无边框的形状。大多数块编程环境在每个块周围都有突出显示和阴影，所以当今天的平面设计师看到这些时，它们总是消除这些过时的装饰。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-bd7a4d3948ed3bbd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>从上面的五个块（来自scriptr.io）的示例中可以看出，这些“过时的装饰”对于区分相同颜色的连接块是至关重要的。</p>
<blockquote>
<p>建议：如果美化你的 Blockly，（原文：<em>If reskinning Blockly, don’t let today’s fashions break your app.</em> 感觉是谷歌打字错了,或者其他语言吧）不要让今天的方式打破你的应用程序。</p>
</blockquote>
<p>##2. 嵌套子堆栈</p>
<hr>
<p>“C”形块在内侧顶部上总是具有连接器，但是一些环境在内侧底部具有连接器（例如，Wonder Workshop），而其他环境则不具有连接器（例如Blockly和Scratch）。由于大多数语句块都有顶部和底部连接器，一些用户不会立即看到该语句将适合没有底部连接器的“C”。<br><img src="http://upload-images.jianshu.io/upload_images/2433593-63d2e530417606fe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>一旦用户确定一个语句块适合在’C’内，他们然后需要找出更多的一个语句也适合。一些环境将第一个语句的低级连接嵌套到“C”的底部（例如Wonder Workshop和Scratch），而其他语言留下一个小间隙（例如Blockly）。嵌套嵌套没有暗示更多的块可以堆叠。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-0ed2260de6c57dea.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>这两个问题彼此互相影响很大。如果内部底层连接器存在（Wonder Workshop），则初始语句的连接变得更加明显，但是以发现堆栈的能力为代价</p>
<p>如果没有内部底部连接器存在（阻塞），则初始语句的连接不明显，但堆叠是可发现的。没有内部底部连接器和嵌套语句的底部连接器（Scratch）在使用Blockly测试时遇到了最糟糕的视觉效果（// 原文：discoverability 。翻译的可能不恰当）。</p>
<p>我们的经验是，初始语句的连接对用户来说是一个较小的挑战，而不是发现堆栈。一旦发现，前者从来不被遗忘，而后者需要提示。</p>
<p>Blockly尝试了Wonder Workshop和Scratch方法，直到有一天出现一个渲染错误，这增加了小的差距。我们看到由于这个错误（现在是我们感到自豪的“功能”）的Blockly用户学习中有明显的改善。</p>
<blockquote>
<p>建议：如果reskinning Blockly，保留现有的堆叠UI。</p>
</blockquote>
<p>##3.对称连接</p>
<hr>
<p>Blockly有两种不同的连接类型：水平拼图形状和垂直堆叠凹槽。良好的用户界面应努力使设计元素的数量最小化。因此，许多设计者试图使两种连接类型看起来相同（如下所示）。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-ca6d80fcbf3c53fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>结果造成新用户之间的混乱，因为他们搜索旋转块的方式，以便它们可以适应不兼容的连接。阻止使编程元素视觉和有形，所以人们必须注意不经意地建议不支持的用户交互。<br>因此，Blockly使用紧配合的拼图形状用于值连接，以及用于语句堆叠的视觉上不同的对齐凹口。</p>
<blockquote>
<p>建议：如果reskinning Blockly，确保水平和垂直连接看起来不同。</p>
</blockquote>
<p>##4.变量和函数名称</p>
<hr>
<p>新手程序员不希望location_X和location_x是不同的变量。因此，Blockly通过使变量和函数不区分大小写遵循BASIC和HTML的规范。 Scratch使用更微妙的方法（如右侧所示），并且对变量名称区分大小写，但不对等式检查。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-7f63c3e49e7957b2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>此外，Blockly不要求变量和函数符合典型的[_A-Za-z] [_A-Za-z0-9] *方案。如果想要命名一个变量列表的邮政编码或רשימתמיקודים完全没关系。</p>
<blockquote>
<p>建议：忽略大小写，允许任何名称。</p>
</blockquote>
<p>##5.全局变量</p>
<hr>
<p>新手程序员也很难理解范围。因此，Blockly通过使所有变量为全局跟随Scratch的线索。全局变量的唯一缺点是递归比较难（必须将变量推入和弹出到列表中），但这是一个超出Blockly目标用户范围的编程技术。</p>
<p>建议：范围超出范围，留待以后使用。</p>
<p>##6. 说明</p>
<hr>
<p>Blockly Games专门设计为自学，不需要教师或课程计划。为了做到这一点，Blockly游戏的第一个版本在每个级别有说明。大多数学生不会读他们。我们将它们缩减为一个句子，增加字体大小，并在黄色气泡中突出显示。大多数学生不会读他们。我们使用说明创建了模态弹出窗口。大多数学生本能地关闭弹出窗口而没有阅读它们，然后就没有然后了。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-2e47a594fcb7c765.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>最后，我们创建了无法关闭的弹出窗口。它们被编程以监视学生的行为，并且仅在学生已经执行禁止的动作时闭合自己。这些上下文感知弹出窗口是有挑战性的程序，但相当有效。对他们来说也是重要的，在视野中不干扰工作空间。</p>
<blockquote>
<p>建议：说明书应该短而持久，但不要令人讨厌。</p>
</blockquote>
<p>##7.代码所有权</p>
<hr>
<p>设计用于教授特定概念的练习通常提供部分解决方案，学生需要修改以达到期望的效果。在Blockly中创建了一类不可编辑，不可移动，不可删除的块来支持它。然而，学生讨厌这些填空题练习。他们对解决方案没有主人翁感。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-bcc1485c9a07c33c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>设计教授相同概念的自由形式练习更具挑战性。已经证明成功的一种技术是使用学生自己的解决方案作为下一次练习的起点。</p>
<p>建议：不要为用户编写代码。</p>
<p>##8.工作区布局</p>
<hr>
<p>有两种合理的方法从左到右布局屏幕。一种方法是从左侧的工具栏开始，中间的工作区，右侧的输出可视化。此布局由Scratch的版本1以及Made with Code使用。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-d775f34e7054a88f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>另一种方式从左侧的输出可视化，中间的工具栏和右侧的工作区开始。此布局由Scratch的版本2以及大多数Blockly应用程序使用。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2433593-d4f106e3c639d9ba.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>在任一情况下，工作空间应该伸展到占用可用的屏幕大小 - 用户需要尽可能多的空间来编程，因为他们可以得到。从上面的截图中可以看出，第一个布局在宽屏幕上表现不佳，因为用户的代码和输出可视化是分开的。而第二布局允许用于较大程序的额外空间，同时仍然保持所有三个部分靠近在一起。</p>
<p>对于用户来说，首先考虑他们试图解决的问题，然后查看提供的工具，然后才开始编程也是合乎逻辑的。</p>
<p>当然，整个指令需要翻译为阿拉伯语和希伯来语翻译。</p>
<p>在一些情况下，例如当使用少量简单块时，工具箱在工作空间上方或下方可能是有意义的。在这些情况下，在工具箱中阻止支持水平滚动，但应谨慎使用。</p>
<p>建议：将程序可视化放在工具栏旁边。</p>
<p>##9.谢幕的策略</p>
<hr>
<p>基于块的编程通常是编程的起点。在教授计算机编程的情况下，它是一种网关药物，让学生上瘾，在他们去学习更难的东西之前。这个基于块的编程周期应该持续多长时间给学生激烈的争论，但如果你的目标是教程序，它应该是暂时的.</p>
<p>鉴于此，用于教学编程的基于块的编程环境必须具有适合于他们的学生的偏离坡道。 Blockly Games有四种策略：</p>
<ol>
<li>块上的所有文本（例如“if”，“while”）是小写以匹配基于文本的编程语言。</li>
<li>学生代码的JavaScript版本始终显示在每个级别之后，以提高熟悉程度。</li>
<li>在倒数第二个游戏中，块文本被替换为实际的JavaScript（如右所示）。此时学生正在使用JavaScript进行编程。</li>
<li>在终极游戏中，块编辑器被替换为文本编辑器。</li>
</ol>
<p>基于块的编程环境用于教学编程需要有一个具体的计划，以毕业他们的学生。一个坚实的退出策略也将大大有助于那些认为基于块的编程不是“真正的编程”的人。</p>
<blockquote>
<p>建议：适当考虑用户的目标和设计。</p>
</blockquote>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2016 xushun
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>